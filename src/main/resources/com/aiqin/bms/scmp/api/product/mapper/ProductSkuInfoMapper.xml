<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiqin.bms.scmp.api.product.mapper.ProductSkuInfoMapper">
  <resultMap id="BaseResultMap" type="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuInfo">
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="sku_code" jdbcType="VARCHAR" property="skuCode" />
    <result column="sku_name" jdbcType="VARCHAR" property="skuName" />
    <result column="sku_abbreviation" jdbcType="VARCHAR" property="skuAbbreviation" />
    <result column="product_code" jdbcType="VARCHAR" property="productCode" />
    <result column="product_name" jdbcType="VARCHAR" property="productName" />
    <result column="product_brand_code" jdbcType="VARCHAR" property="productBrandCode" />
    <result column="product_brand_name" jdbcType="VARCHAR" property="productBrandName" />
    <result column="product_category_code" jdbcType="VARCHAR" property="productCategoryCode" />
    <result column="product_category_name" jdbcType="VARCHAR" property="productCategoryName" />
    <result column="goods_gifts" jdbcType="TINYINT" property="goodsGifts" />
    <result column="product_property_code" jdbcType="VARCHAR" property="productPropertyCode" />
    <result column="product_property_name" jdbcType="VARCHAR" property="productPropertyName" />
    <result column="product_sort_code" jdbcType="VARCHAR" property="productSortCode" />
    <result column="product_sort_name" jdbcType="VARCHAR" property="productSortName" />
    <result column="procurement_section_code" jdbcType="VARCHAR" property="procurementSectionCode" />
    <result column="procurement_section_name" jdbcType="VARCHAR" property="procurementSectionName" />
    <result column="color_code" jdbcType="VARCHAR" property="colorCode" />
    <result column="color_name" jdbcType="VARCHAR" property="colorName" />
    <result column="model_number" jdbcType="VARCHAR" property="modelNumber" />
    <result column="management_style_code" jdbcType="VARCHAR" property="managementStyleCode" />
    <result column="management_style_name" jdbcType="VARCHAR" property="managementStyleName" />
    <result column="quality_assurance_management" jdbcType="TINYINT" property="qualityAssuranceManagement" />
    <result column="quality_number" jdbcType="VARCHAR" property="qualityNumber" />
    <result column="quality_date" jdbcType="VARCHAR" property="qualityDate" />
    <result column="categories_supply_channels_code" jdbcType="VARCHAR" property="categoriesSupplyChannelsCode" />
    <result column="categories_supply_channels_name" jdbcType="VARCHAR" property="categoriesSupplyChannelsName" />
    <result column="seasonal_goods" jdbcType="TINYINT" property="seasonalGoods" />
    <result column="structural_goods" jdbcType="TINYINT" property="structuralGoods" />
    <result column="manufacturer_guide_price" jdbcType="BIGINT" property="manufacturerGuidePrice" />
    <result column="applicable_month_age" jdbcType="VARCHAR" property="applicableMonthAge" />
    <result column="mnemonic_code" jdbcType="VARCHAR" property="mnemonicCode" />
    <result column="warehouse_type_code" jdbcType="VARCHAR" property="warehouseTypeCode" />
    <result column="warehouse_type_name" jdbcType="VARCHAR" property="warehouseTypeName" />
    <result column="is_main_push" jdbcType="TINYINT" property="isMainPush" />
    <result column="new_product" jdbcType="TINYINT" property="newProduct" />
    <result column="remark" jdbcType="VARCHAR" property="remark" />
    <result column="selection_effective_time" jdbcType="TINYINT" property="selectionEffectiveTime" />
    <result column="selection_effective_start_time" jdbcType="VARCHAR" property="selectionEffectiveStartTime" />
    <result column="selection_effective_end_time" jdbcType="VARCHAR" property="selectionEffectiveEndTime" />
    <result column="sku_status" jdbcType="TINYINT" property="skuStatus" />
    <result column="on_sale" jdbcType="TINYINT" property="onSale" />
    <result column="company_code" jdbcType="VARCHAR" property="companyCode" />
    <result column="company_name" jdbcType="VARCHAR" property="companyName" />
    <result column="apply_code" jdbcType="VARCHAR" property="applyCode" />
    <result column="apply_status" jdbcType="TINYINT" property="applyStatus" />
    <result column="auditor_by" jdbcType="VARCHAR" property="auditorBy" />
    <result column="auditor_time" jdbcType="TIMESTAMP" property="auditorTime" />
    <result column="del_flag" jdbcType="TINYINT" property="delFlag" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="create_by" jdbcType="VARCHAR" property="createBy" />
    <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="update_by" jdbcType="VARCHAR" property="updateBy" />
    <result column="spec" jdbcType="VARCHAR" property="spec" />
    <result column="unit_name" jdbcType="VARCHAR" property="unitName" />
    <result column="unit_code" jdbcType="VARCHAR" property="unitCode" />
    <result column="box_gauge" jdbcType="VARCHAR" property="boxGauge" />
    <result column="point" jdbcType="VARCHAR" property="point" />
    <result column="spu_code" jdbcType="VARCHAR" property="spuCode" />
    <result column="bar_code" jdbcType="VARCHAR" property="barCode" />
    <result column="logo" jdbcType="VARCHAR" property="logo" />
    <result column="images" jdbcType="VARCHAR" property="images" />
    <result column="itro_images" jdbcType="VARCHAR" property="itroImages" />
    <result column="zero_removal_coefficient" jdbcType="BIGINT" property="zeroRemovalCoefficient" />
    <result column="use_time" jdbcType="INTEGER" property="useTime" />
    <result column="unique_code" jdbcType="TINYINT" property="uniqueCode" />
    <result column="inventory_model" jdbcType="TINYINT" property="inventoryModel" />
    <result column="inventory_allocation" jdbcType="TINYINT" property="inventoryAllocation" />
    <result column="price_model" jdbcType="TINYINT" property="priceModel" />
    <result column="product_desc" jdbcType="VARCHAR" property="productDesc" />
      <result column="item_number" jdbcType="VARCHAR" property="itemNumber" />
      <result column="level" jdbcType="VARCHAR" property="level" />
      <result column="season_band" jdbcType="VARCHAR" property="seasonBand" />
      <result column="feature_code" jdbcType="VARCHAR" property="featureCode" />
      <result column="feature_name" jdbcType="VARCHAR" property="featureName" />
      <result column="currency_level_code" jdbcType="VARCHAR" property="currencyLevelCode" />
      <result column="currency_level_name" jdbcType="VARCHAR" property="currencyLevelName" />
  </resultMap>
  <sql id="Base_Column_List">
    id, sku_code, sku_name, sku_abbreviation, product_code, product_name, product_brand_code,
    product_brand_name, product_category_code, product_category_name, goods_gifts, product_property_code,
    product_property_name, product_sort_code, product_sort_name, procurement_section_code,
    procurement_section_name, color_code, color_name, model_number, management_style_code,
    management_style_name, quality_assurance_management, quality_number, quality_date,
    categories_supply_channels_code, categories_supply_channels_name, seasonal_goods,
    structural_goods, manufacturer_guide_price, applicable_month_age, mnemonic_code,
    warehouse_type_code, warehouse_type_name, is_main_push, new_product, remark, selection_effective_time,
    selection_effective_start_time, selection_effective_end_time, sku_status, on_sale,
    company_code, company_name, apply_code, apply_status, auditor_by, auditor_time, del_flag,
    create_time, create_by, update_time, update_by, spec, unit_name, unit_code, box_gauge,
    point, spu_code, bar_code, logo, images, itro_images, zero_removal_coefficient, use_time,
    unique_code, inventory_model, inventory_allocation, price_model,product_desc
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from product_sku
    where id = #{id,jdbcType=BIGINT}
  </select>

    <select id="selectBySkuCode" parameterType="java.lang.String" resultMap="BaseResultMap">
        select *
        from product_sku
        where sku_code = #{skuCode,jdbcType=VARCHAR}
    </select>
  <select id="selectBySkuCodes" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from product_sku
    where company_code = #{companyCode} and
    sku_code in
    <foreach collection="list" open="(" close=")" separator="," item="item">
        #{item}
    </foreach>
  </select>
  <select id="getAll" resultType="java.lang.String">
      select
       distinct a.sku_name
      from product_sku a,apply_product_sku b
      where a.del_flag = 0 and a.sku_name = b.sku_name and b.apply_code = #{applyCode} and b.apply_type = 1
  </select>
  <select id="checkBrand" resultType="java.lang.Integer">
    select
    count(0)
    from
    product_sku where product_brand_code = #{brandCode}
  </select>
  <select id="checkCategory" resultType="java.lang.Integer">
    select
    count(0)
    from
    product_sku where product_category_code = #{categoryCode}
  </select>
  <select id="selectBySkuNames" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from product_sku
    where company_code = #{companyCode} and
    sku_name in
    <foreach collection="list" open="(" close=")" separator="," item="item">
      #{item}
    </foreach>
  </select>
    <select id="exportAddSku" resultType="com.aiqin.bms.scmp.api.product.domain.excel.SkuAddExport">
        select a.sku_code                                 skuCode,
       a.sku_name                                 skuName,
       a.sku_abbreviation                         skuAbbreviation,
       a.mnemonic_code                            mnemonicCode,
       c.spec                                     spec,
       c.unit_name                                unitName,
       0 as                                       decimalPlaces,
       a.applicable_month_age                     applicableMonthAge,
       case
           when a.quality_assurance_management = 0
               then '是'
           when a.quality_assurance_management = 1
               then '否'
           end                                    qualityAssuranceManagement,
       a.quality_date                             qualityDate,
       case
           when a.quality_number = 1
               then '天'
           when a.quality_number = 2
               then '月'
           when a.quality_number = 3
               then '年'
           end                                    qualityNumber,
       case
       when left(a.product_category_code, 2) in ('01','02','03','04','05')
           then '是'
       else
                '否'
       end                                        qualityAssuranceManagement2,
       a.quality_date                             qualityDate,
       d.box_gross_weight                         boxGrossWeight,
       a.product_brand_name                       productBrandName,
       a.product_category_code                    productCategoryCode,
       CONCAT(lv1.category_name, '-', lv2.category_name, '-', lv3.category_name, '-',
    lv4.category_name) as       productCategoryName,
       a.management_style_name                    managementStyleName,
       e.sales_code                               salesCode,
       f.zero_removal_coefficient                 zeroRemovalCoefficient,
       g.output_tax_rate             outputTaxRate,
       g.Input_tax_rate              inputTaxRate,
       g.settlement_method_name                   settlementMethodName,
       a.procurement_section_name                 procurementSectionName,
       case
        when a.product_property_name = 'A+品'
           then 'A品'
       else
             a.product_property_name
       end                                        productPropertyName,
       g.Integral_coefficient                     integralCoefficient,
       a.manufacturer_guide_price    manufacturerGuidePrice,
       h.price_tax                   salePrice,
       i.price_tax                   memberPrice,
       j.categories_supply_channels_name          categoriesSupplyChannelsName,
       j.tax_included_price                       basePrice,
       ROUND(((i2.price_tax-j.tax_included_price)/j.tax_included_price*100),4)                               addPoints2,
       ROUND(((i3.price_tax-j.tax_included_price)/j.tax_included_price*100),4)                               addPoints3,
       ROUND(((i4.price_tax-j.tax_included_price)/j.tax_included_price*100),4)                               addPoints4,
       ROUND(((i5.price_tax-j.tax_included_price)/j.tax_included_price*100),4)                               addPoints5,
       ROUND(((i6.price_tax-j.tax_included_price)/j.tax_included_price*100),4)                               addPoints6,
       ROUND(((i7.price_tax-j.tax_included_price)/j.tax_included_price*100),4)                               addPoints7,
       ROUND(((i8.price_tax-j.tax_included_price)/j.tax_included_price*100),4)                               addPoints8,
       k.manufacturer_name                        manufacturerName,
       k.factory_product_number                   factoryProductNumber,
       k.address                                  address,
       concat(a.sku_code, l.base_product_content) inProductSkuCode,
       l.spec                                     inSpec,
       l.unit_name                                inUnitName,
       l.purchase_code                            inPurchaseCode,
       l.base_product_content                     inBaseProductContent,
       concat(a.sku_code, l.base_product_content) outProductSkuCode,
       l.spec                                     outSpec,
       l.unit_name                                outUnitName,
       l.purchase_code                            outPurchaseCode,
       l.base_product_content                     outBaseProductContent,
       a.sku_code                                 saleSkuCode,
       e.spec                                     saleSpec,
       e.small_unit                               saleUnit,
       e.sales_code                               salesCode2,
       e.base_product_content                     saleBaseProductContent,
       d.box_length                 saleBoxLength,
       d.box_width                   saleBoxWidth,
       d.box_height                  saleBoxHeight,
       j.supply_unit_code                         supplyUnitCode,
       j.supply_unit_name                         supplyUnitName,
       j.tax_included_price                  taxIncludedPrice,
       j.joint_franchise_rate                     jointFranchiseRate,
       j.point                                    point,
       case
           when a.sku_status = 0
               then '在用'
           when a.sku_status = 1
               then '停止进货'
           when a.sku_status = 2
               then '停止配送'
           when a.sku_status = 3
               then '停止销售'
           end                                    skuStatus,
       a.product_desc                             remark,
       a.warehouse_type_name                      warehouseTypeName,
       a.color_name                               colorName,
       case
           when a.unique_code = 0
               then '是'
           when a.unique_code = 1
               then '否'
           end                                    uniqueCode
from product_sku a
         inner join
     (select sku_code
      from apply_product_sku
      where sku_code not in(select sku_code
                       from apply_product_sku
                       where apply_type = 2
                         and apply_status = 2
                       order by create_time desc)
        and apply_status = 2 and apply_code = #{applyCode}) b
     on a.sku_code = b.sku_code
         left join product_sku_stock_info c on a.sku_code = c.product_sku_code
         left join product_sku_box_packing d on d.unit_code = c.unit_code and d.product_sku_code = a.sku_code
         left join product_sku_sales_info e on e.product_sku_code = a.sku_code and e.is_default = 1
         left join product_sku_distribution_info f on a.sku_code = f.product_sku_code
         left join product_sku_checkout g on g.sku_code = a.sku_code
         left join product_sku_price_info h on h.sku_code = a.sku_code and h.price_item_code = '1013' #售价
         left join product_sku_price_info i on i.sku_code = a.sku_code and i.price_item_code = '1014' #会员价
         left join product_sku_supply_unit j on j.product_sku_code = a.sku_code and j.is_default = 1
         left join product_sku_price_info i2 on i2.sku_code = a.sku_code and i2.price_item_code = '1007' #爱亲分销价
         left join product_sku_price_info i3 on i3.sku_code = a.sku_code and i3.price_item_code = '1008' #萌贝树分销价
         left join product_sku_price_info i4 on i4.sku_code = a.sku_code and i4.price_item_code = '1007' #爱亲分销价
         left join product_sku_price_info i5 on i5.sku_code = a.sku_code and i5.price_item_code = '1001' #爱亲渠道价
         left join product_sku_price_info i6 on i6.sku_code = a.sku_code and i6.price_item_code = '1002' #萌贝树渠道价
         left join product_sku_price_info i7 on i7.sku_code = a.sku_code and i7.price_item_code = '1003' #小红马渠道价
         left join product_sku_price_info i8 on i8.sku_code = a.sku_code and i8.price_item_code = '1009' #小红马分销价
         left join product_sku_manufacturer k on a.sku_code = k.product_sku_code and k.is_default = 1
         left join product_sku_purchase_info l on l.product_sku_code = a.sku_code
         LEFT JOIN product_category lv4 on lv4.category_id = a.product_category_code
         LEFT JOIN product_category lv3 on lv3.category_id = lv4.parent_id
         LEFT JOIN product_category lv2 on lv2.category_id = lv3.parent_id
         LEFT JOIN product_category lv1 on lv1.category_id = lv2.parent_id
    </select>
    <select id="exportSku" resultType="com.aiqin.bms.scmp.api.product.domain.excel.SkuInfoExport">
      select
        case when a.goods_gifts = 0 then '商品' when  a.goods_gifts = 1 then '赠品' when  a.goods_gifts = 2 then '组合商品' end goodsGifts,
        a.product_sort_name productSortName,
        a.product_category_code                    productCategoryCode,
        CONCAT(lv1.category_name, '-', lv2.category_name, '-', lv3.category_name, '-',lv4.category_name) as       productCategoryName,
        a.sku_code                         skuCode,
        a.sku_name                         skuName,
        a.sku_abbreviation                 skuAbbreviation,
        a.mnemonic_code  mnemonicCode,
        b.product_name   productName,
        b.abbreviation   productAbbreviation,
        b.bar_code       productBarCode,
        b.style_number   productStyleNumber,
        a.item_number    itemNumber,
        case when a.product_property_name = 'A+品'then 'A品' else a.product_property_name end productPropertyName,
        a.product_brand_name                       productBrandName,
        a.procurement_section_name                 procurementSectionName,
        a.color_name   colorName,
        a.model_number modelNumber,
        case
           when a.quality_assurance_management = 0
               then '是'
           when a.quality_assurance_management = 1
               then '否'
           end                                    qualityAssuranceManagement,
       a.quality_date                             qualityDate,
       case
           when a.quality_number = 1
               then '天'
           when a.quality_number = 2
               then '月'
           when a.quality_number = 3
               then '年'
           end                                    qualityNumber,
      a.applicable_month_age                     applicableMonthAge,
      case
           when a.seasonal_goods = 0
               then '是'
           when a.seasonal_goods = 1
               then '否'
           end                                    seasonalGoodsDesc,
      case
           when a.structural_goods = 0
               then '是'
           when a.structural_goods = 1
               then '否'
           end                                    structuralGoodsDesc,
      a.warehouse_type_name                      warehouseTypeName,
      a.use_time useTime,
      a.season_band seasonBand,
      case
           when a.unique_code = 0
               then '是'
           when a.unique_code = 1
               then '否'
           end                                    uniqueCode,
      a.level level,
      a.feature_name featureName,
      a.currency_level_name currencyLevelName,
      a.remark                           remark,
      a.product_desc                             productDesc,
      a.manufacturer_guide_price manufacturerGuidePrice,
      j.tax_included_price taxIncludedPrice,
      i5.price_tax readyCol67,
      i6.price_tax readyCol68,
      i7.price_tax readyCol69,
      i2.price_tax readyCol70,
      i3.price_tax readyCol71,
      i4.price_tax readyCol72,
      h.price_tax readyCol73,
      i.price_tax readyCol74,
      j.supply_unit_code supplyUnitCode,
      j.supply_unit_name supplyUnitName,
      j.joint_franchise_rate                    jointFranchiseRate,
      j.point                                    point,
      j.factory_sku_code                        factorySkuCode,
      j.categories_supply_channels_name        categoriesSupplyChannelsName,
      c.spec                                     stockSpec,
      c.unit_name                                stockUnitName,
      d.box_length                 stockBoxLength,
      d.box_width                  stockBoxWidth,
      d.box_height                 stockBoxHeight,
      d.box_volume                 stockBoxVolume,
      d.box_gross_weight           stockBoxGrossWeight,
      d.net_weight                 stockNetWeight,
      e.spec                       purchaseSpec,
      e.unit_name                  purchaseUnitName,
      f.box_length                 purchaseBoxLength,
      f.box_width                  purchaseBoxWidth,
      f.box_height                 purchaseBoxHeight,
      f.box_volume                  stockBoxVolume,
      f.box_gross_weight          purchaseBoxGrossWeight,
      f.net_weight                 purchaseNetWeight,
      e.zero_removal_coefficient   purchaseBaseProductContent,
      e.purchase_code             stockBarCode,
      m.zero_removal_coefficient distributionZeroRemovalCoefficient,
      m.max_order_num maxOrderNum,
      n.sales_code saleBarCode,
      n.description description,
      g.settlement_method_name settlementMethodName,
      g.Input_tax_rate inputTaxRate,
      g.output_tax_rate outputTaxRate,
      g.Integral_coefficient integralCoefficient,
      g.logistics_fee_award_ratio logisticsFeeAwardRatio,
      k.manufacturer_name manufacturerName,
      k.factory_product_number factoryProductNumber,
      k.address address,
      case
           when config.config_status = 0
               then '在用'
           when config.config_status = 1
               then '停止进货'
           when config.config_status = 2
               then '停止配送'
           when config.config_status = 3
               then '停止销售'
           end
      readyCol76,
      case
           when config1.config_status = 0
               then '在用'
           when config1.config_status = 1
               then '停止进货'
           when config1.config_status = 2
               then '停止配送'
           when config1.config_status = 3
               then '停止销售'
           end
      readyCol77,
      case
           when config2.config_status = 0
               then '在用'
           when config2.config_status = 1
               then '停止进货'
           when config2.config_status = 2
               then '停止配送'
           when config2.config_status = 3
               then '停止销售'
           end
      readyCol78,
      case
           when config3.config_status = 0
               then '在用'
           when config3.config_status = 1
               then '停止进货'
           when config3.config_status = 2
               then '停止配送'
           when config3.config_status = 3
               then '停止销售'
           end
      readyCol79,
      case
           when config4.config_status = 0
               then '在用'
           when config4.config_status = 1
               then '停止进货'
           when config4.config_status = 2
               then '停止配送'
           when config4.config_status = 3
               then '停止销售'
           end readyCol80
		from (select * from product_sku where sku_code in (${skuCodes})) a
		 left join product b on a.product_code = b.product_code
         left join product_sku_stock_info c on a.sku_code = c.product_sku_code
         left join product_sku_box_packing d on d.unit_code = c.unit_code and d.product_sku_code = a.sku_code
         left join product_sku_purchase_info e on e.product_sku_code = a.sku_code
         left join product_sku_box_packing f on e.unit_code = f.unit_code and f.product_sku_code = a.sku_code
         left join product_sku_distribution_info m on m.product_sku_code = a.sku_code
         left join product_sku_sales_info n on n.product_sku_code = a.sku_code and n.is_default = 1
         left join product_sku_checkout g on g.sku_code = a.sku_code
         left join product_sku_price_info h on h.sku_code = a.sku_code and h.price_item_code = '1013'
         left join product_sku_price_info i on i.sku_code = a.sku_code and i.price_item_code = '1014'
         left join product_sku_supply_unit j on j.product_sku_code = a.sku_code and j.is_default = 1
         left join product_sku_price_info i2 on i2.sku_code = a.sku_code and i2.price_item_code = '1007'
         left join product_sku_price_info i3 on i3.sku_code = a.sku_code and i3.price_item_code = '1008'
         left join product_sku_price_info i4 on i4.sku_code = a.sku_code and i4.price_item_code = '1009'
         left join product_sku_price_info i5 on i5.sku_code = a.sku_code and i5.price_item_code = '1001'
         left join product_sku_price_info i6 on i6.sku_code = a.sku_code and i6.price_item_code = '1002'
         left join product_sku_price_info i7 on i7.sku_code = a.sku_code and i7.price_item_code = '1003'
         left join product_sku_manufacturer k on a.sku_code = k.product_sku_code and k.is_default = 1 and k.del_flag = 0
         LEFT JOIN product_category lv4 on lv4.category_id = a.product_category_code
         LEFT JOIN product_category lv3 on lv3.category_id = lv4.parent_id
         LEFT JOIN product_category lv2 on lv2.category_id = lv3.parent_id
         LEFT JOIN product_category lv1 on lv1.category_id = lv2.parent_id
         left join product_sku_config config on config.sku_code = a.sku_code and config.transport_center_code = '1081'
         left join product_sku_config config1 on config1.sku_code = a.sku_code and config1.transport_center_code = '1083'
         left join product_sku_config config2 on config2.sku_code = a.sku_code and config2.transport_center_code = '1084'
         left join product_sku_config config3 on config3.sku_code = a.sku_code and config3.transport_center_code = '1082'
         left join product_sku_config config4 on config4.sku_code = a.sku_code and config4.transport_center_code = '1085'
    </select>
    <select id="exportEditSku" resultType="com.aiqin.bms.scmp.api.product.domain.excel.SkuEditExport">
        select a.sku_code                                 skuCode,
               a.sku_name                                 skuName,
               a.sku_abbreviation                         skuAbbreviation,
               c.spec                                     spec,
               c.unit_name                                unitName,
               a.applicable_month_age                     applicableMonthAge,
               f.zero_removal_coefficient                 zeroRemovalCoefficient,
                case
                when a.product_property_name = 'A+品'
                   then 'A品'
                else
                     a.product_property_name
                end                                        productPropertyName,
               a.manufacturer_guide_price    manufacturerGuidePrice,
               case
                    when a.sku_status = 0
                        then '在用'
                    when a.sku_status = 1
                        then '停止进货'
                    when a.sku_status = 2
                        then '停止配送'
                    when a.sku_status = 3
                        then '停止销售'
                end                                       skuStatus,
               a.warehouse_type_name                      warehouseTypeName,
               a.color_name                               colorName,
               case
                   when a.unique_code = 0
                       then '是'
                   when a.unique_code = 1
                       then '否'
                   end                                    uniqueCode
        from product_sku a
                 inner join
             (select sku_code
              from apply_product_sku
              where sku_code in (select sku_code
                           from apply_product_sku
                           where apply_type = 2
                             and apply_status = 2
                           order by create_time desc)
                and apply_status = 2 and apply_code = #{applyCode}) b
             on a.sku_code = b.sku_code
                 left join product_sku_stock_info c on a.sku_code = c.product_sku_code
                 left join product_sku_box_packing d on d.unit_code = c.unit_code and d.product_sku_code = a.sku_code
                 left join product_sku_distribution_info f on a.sku_code = f.product_sku_code
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    delete from product_sku
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuInfo">
    insert into product_sku (id, sku_code, sku_name,
      sku_abbreviation, product_code, product_name,
      product_brand_code, product_brand_name, product_category_code,
      product_category_name, goods_gifts, product_property_code,
      product_property_name, product_sort_code, product_sort_name,
      procurement_section_code, procurement_section_name,
      color_code, color_name, model_number,
      management_style_code, management_style_name,
      quality_assurance_management, quality_number,
      quality_date, categories_supply_channels_code,
      categories_supply_channels_name, seasonal_goods,
      structural_goods, manufacturer_guide_price,
      applicable_month_age, mnemonic_code, warehouse_type_code,
      warehouse_type_name, is_main_push, new_product,
      remark, selection_effective_time, selection_effective_start_time,
      selection_effective_end_time, sku_status, on_sale,
      company_code, company_name, apply_code,
      apply_status, auditor_by, auditor_time,
      del_flag, create_time, create_by,
      update_time, update_by, spec,
      unit_name, unit_code, box_gauge,
      point, spu_code, bar_code,
      logo, images, itro_images,
      zero_removal_coefficient, use_time, unique_code,
      inventory_model, inventory_allocation, price_model,product_desc
      )
    values (#{id,jdbcType=BIGINT}, #{skuCode,jdbcType=VARCHAR}, #{skuName,jdbcType=VARCHAR},
      #{skuAbbreviation,jdbcType=VARCHAR}, #{productCode,jdbcType=VARCHAR}, #{productName,jdbcType=VARCHAR},
      #{productBrandCode,jdbcType=VARCHAR}, #{productBrandName,jdbcType=VARCHAR}, #{productCategoryCode,jdbcType=VARCHAR},
      #{productCategoryName,jdbcType=VARCHAR}, #{goodsGifts,jdbcType=TINYINT}, #{productPropertyCode,jdbcType=VARCHAR},
      #{productPropertyName,jdbcType=VARCHAR}, #{productSortCode,jdbcType=VARCHAR}, #{productSortName,jdbcType=VARCHAR},
      #{procurementSectionCode,jdbcType=VARCHAR}, #{procurementSectionName,jdbcType=VARCHAR},
      #{colorCode,jdbcType=VARCHAR}, #{colorName,jdbcType=VARCHAR}, #{modelNumber,jdbcType=VARCHAR},
      #{managementStyleCode,jdbcType=VARCHAR}, #{managementStyleName,jdbcType=VARCHAR},
      #{qualityAssuranceManagement,jdbcType=TINYINT}, #{qualityNumber,jdbcType=VARCHAR},
      #{qualityDate,jdbcType=VARCHAR}, #{categoriesSupplyChannelsCode,jdbcType=VARCHAR},
      #{categoriesSupplyChannelsName,jdbcType=VARCHAR}, #{seasonalGoods,jdbcType=TINYINT},
      #{structuralGoods,jdbcType=TINYINT}, #{manufacturerGuidePrice,jdbcType=DECIMAL},
      #{applicableMonthAge,jdbcType=VARCHAR}, #{mnemonicCode,jdbcType=VARCHAR}, #{warehouseTypeCode,jdbcType=VARCHAR},
      #{warehouseTypeName,jdbcType=VARCHAR}, #{isMainPush,jdbcType=TINYINT}, #{newProduct,jdbcType=TINYINT},
      #{remark,jdbcType=VARCHAR}, #{selectionEffectiveTime,jdbcType=TINYINT}, #{selectionEffectiveStartTime,jdbcType=VARCHAR},
      #{selectionEffectiveEndTime,jdbcType=VARCHAR}, #{skuStatus,jdbcType=TINYINT}, #{onSale,jdbcType=TINYINT},
      #{companyCode,jdbcType=VARCHAR}, #{companyName,jdbcType=VARCHAR}, #{applyCode,jdbcType=VARCHAR},
      #{applyStatus,jdbcType=TINYINT}, #{auditorBy,jdbcType=VARCHAR}, #{auditorTime,jdbcType=TIMESTAMP},
      #{delFlag,jdbcType=TINYINT}, #{createTime,jdbcType=TIMESTAMP}, #{createBy,jdbcType=VARCHAR},
      #{updateTime,jdbcType=TIMESTAMP}, #{updateBy,jdbcType=VARCHAR}, #{spec,jdbcType=VARCHAR},
      #{unitName,jdbcType=VARCHAR}, #{unitCode,jdbcType=VARCHAR}, #{boxGauge,jdbcType=VARCHAR},
      #{point,jdbcType=VARCHAR}, #{spuCode,jdbcType=VARCHAR}, #{barCode,jdbcType=VARCHAR},
      #{logo,jdbcType=VARCHAR}, #{images,jdbcType=VARCHAR}, #{itroImages,jdbcType=VARCHAR},
      #{zeroRemovalCoefficient,jdbcType=BIGINT}, #{useTime,jdbcType=INTEGER}, #{uniqueCode,jdbcType=TINYINT},
      #{inventoryModel,jdbcType=TINYINT}, #{inventoryAllocation,jdbcType=TINYINT}, #{priceModel,jdbcType=TINYINT}, #{productDesc,jdbcType=VARCHAR}
      )
  </insert>

  <insert id="insertBatch" parameterType="java.util.List">
    insert into product_sku ( sku_code, sku_name,
      sku_abbreviation, product_code, product_name,
      product_brand_code, product_brand_name, product_category_code,
      product_category_name, goods_gifts, product_property_code,
      product_property_name, product_sort_code, product_sort_name,
      procurement_section_code, procurement_section_name,
      color_code, color_name, model_number,
      management_style_code, management_style_name,
      quality_assurance_management, quality_number,
      quality_date, categories_supply_channels_code,
      categories_supply_channels_name, seasonal_goods,
      structural_goods, manufacturer_guide_price,
      applicable_month_age, mnemonic_code, warehouse_type_code,
      warehouse_type_name, is_main_push, new_product,
      remark, selection_effective_time, selection_effective_start_time,
      selection_effective_end_time, sku_status, on_sale,
      company_code, company_name, apply_code,
      apply_status, auditor_by, auditor_time,
      del_flag, create_time, create_by,
      update_time, update_by, spec,
      unit_name, unit_code, box_gauge,
      point, spu_code, bar_code,
      logo, images, itro_images,
      zero_removal_coefficient, use_time, unique_code,
      inventory_model, inventory_allocation, price_model,product_desc
      )
    values

    <foreach collection="list" item="item" separator=",">
      (#{item.jdbcType=BIGINT}, #{item.skuCode,jdbcType=VARCHAR}, #{item.skuName,jdbcType=VARCHAR},
      #{item.skuAbbreviation,jdbcType=VARCHAR}, #{item.productCode,jdbcType=VARCHAR}, #{item.productName,jdbcType=VARCHAR},
      #{item.productBrandCode,jdbcType=VARCHAR}, #{item.productBrandName,jdbcType=VARCHAR}, #{item.productCategoryCode,jdbcType=VARCHAR},
      #{item.productCategoryName,jdbcType=VARCHAR}, #{item.goodsGifts,jdbcType=TINYINT}, #{item.productPropertyCode,jdbcType=VARCHAR},
      #{item.productPropertyName,jdbcType=VARCHAR}, #{item.productSortCode,jdbcType=VARCHAR}, #{item.productSortName,jdbcType=VARCHAR},
      #{item.procurementSectionCode,jdbcType=VARCHAR}, #{item.procurementSectionName,jdbcType=VARCHAR},
      #{item.colorCode,jdbcType=VARCHAR}, #{item.colorName,jdbcType=VARCHAR}, #{item.modelNumber,jdbcType=VARCHAR},
      #{item.managementStyleCode,jdbcType=VARCHAR}, #{item.managementStyleName,jdbcType=VARCHAR},
      #{item.qualityAssuranceManagement,jdbcType=TINYINT}, #{item.qualityNumber,jdbcType=VARCHAR},
      #{item.qualityDate,jdbcType=VARCHAR}, #{item.categoriesSupplyChannelsCode,jdbcType=VARCHAR},
      #{item.categoriesSupplyChannelsName,jdbcType=VARCHAR}, #{item.seasonalGoods,jdbcType=TINYINT},
      #{item.structuralGoods,jdbcType=TINYINT}, #{item.manufacturerGuidePrice,jdbcType=BIGINT},
      #{item.applicableMonthAge,jdbcType=VARCHAR}, #{item.mnemonicCode,jdbcType=VARCHAR}, #{item.warehouseTypeCode,jdbcType=VARCHAR},
      #{item.warehouseTypeName,jdbcType=VARCHAR}, #{item.isMainPush,jdbcType=TINYINT}, #{item.newProduct,jdbcType=TINYINT},
      #{item.remark,jdbcType=VARCHAR}, #{item.selectionEffectiveTime,jdbcType=TINYINT}, #{item.selectionEffectiveStartTime,jdbcType=VARCHAR},
      #{item.selectionEffectiveEndTime,jdbcType=VARCHAR}, #{item.skuStatus,jdbcType=TINYINT}, #{item.onSale,jdbcType=TINYINT},
      #{item.companyCode,jdbcType=VARCHAR}, #{item.companyName,jdbcType=VARCHAR}, #{item.applyCode,jdbcType=VARCHAR},
      #{item.applyStatus,jdbcType=TINYINT}, #{item.auditorBy,jdbcType=VARCHAR}, #{item.auditorTime,jdbcType=TIMESTAMP},
      #{item.delFlag,jdbcType=TINYINT}, #{item.createTime,jdbcType=TIMESTAMP}, #{item.createBy,jdbcType=VARCHAR},
      #{item.updateTime,jdbcType=TIMESTAMP}, #{item.updateBy,jdbcType=VARCHAR}, #{item.spec,jdbcType=VARCHAR},
      #{item.unitName,jdbcType=VARCHAR}, #{item.unitCode,jdbcType=VARCHAR}, #{item.boxGauge,jdbcType=VARCHAR},
      #{item.point,jdbcType=VARCHAR}, #{item.spuCode,jdbcType=VARCHAR}, #{item.barCode,jdbcType=VARCHAR},
      #{item.logo,jdbcType=VARCHAR}, #{item.images,jdbcType=VARCHAR}, #{item.itroImages,jdbcType=VARCHAR},
      #{item.zeroRemovalCoefficient,jdbcType=BIGINT}, #{item.useTime,jdbcType=INTEGER}, #{item.uniqueCode,jdbcType=TINYINT},
      #{item.inventoryModel,jdbcType=TINYINT}, #{item.inventoryAllocation,jdbcType=TINYINT}, #{item.priceModel,jdbcType=TINYINT}, #{item.productDesc,jdbcType=VARCHAR}
      )
    </foreach>

  </insert>
  <insert id="insertSelective" parameterType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuInfo">
    insert into product_sku
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="skuCode != null">
        sku_code,
      </if>
      <if test="skuName != null">
        sku_name,
      </if>
      <if test="skuAbbreviation != null">
        sku_abbreviation,
      </if>
      <if test="productCode != null">
        product_code,
      </if>
      <if test="productName != null">
        product_name,
      </if>
      <if test="productBrandCode != null">
        product_brand_code,
      </if>
      <if test="productBrandName != null">
        product_brand_name,
      </if>
      <if test="productCategoryCode != null">
        product_category_code,
      </if>
      <if test="productCategoryName != null">
        product_category_name,
      </if>
      <if test="goodsGifts != null">
        goods_gifts,
      </if>
      <if test="productPropertyCode != null">
        product_property_code,
      </if>
      <if test="productPropertyName != null">
        product_property_name,
      </if>
      <if test="productSortCode != null">
        product_sort_code,
      </if>
      <if test="productSortName != null">
        product_sort_name,
      </if>
      <if test="procurementSectionCode != null">
        procurement_section_code,
      </if>
      <if test="procurementSectionName != null">
        procurement_section_name,
      </if>
      <if test="colorCode != null">
        color_code,
      </if>
      <if test="colorName != null">
        color_name,
      </if>
      <if test="modelNumber != null">
        model_number,
      </if>
      <if test="managementStyleCode != null">
        management_style_code,
      </if>
      <if test="managementStyleName != null">
        management_style_name,
      </if>
      <if test="qualityAssuranceManagement != null">
        quality_assurance_management,
      </if>
      <if test="qualityNumber != null">
        quality_number,
      </if>
      <if test="qualityDate != null">
        quality_date,
      </if>
      <if test="categoriesSupplyChannelsCode != null">
        categories_supply_channels_code,
      </if>
      <if test="categoriesSupplyChannelsName != null">
        categories_supply_channels_name,
      </if>
      <if test="seasonalGoods != null">
        seasonal_goods,
      </if>
      <if test="structuralGoods != null">
        structural_goods,
      </if>
      <if test="manufacturerGuidePrice != null">
        manufacturer_guide_price,
      </if>
      <if test="applicableMonthAge != null">
        applicable_month_age,
      </if>
      <if test="mnemonicCode != null">
        mnemonic_code,
      </if>
      <if test="warehouseTypeCode != null">
        warehouse_type_code,
      </if>
      <if test="warehouseTypeName != null">
        warehouse_type_name,
      </if>
      <if test="isMainPush != null">
        is_main_push,
      </if>
      <if test="newProduct != null">
        new_product,
      </if>
      <if test="remark != null">
        remark,
      </if>
      <if test="selectionEffectiveTime != null">
        selection_effective_time,
      </if>
      <if test="selectionEffectiveStartTime != null">
        selection_effective_start_time,
      </if>
      <if test="selectionEffectiveEndTime != null">
        selection_effective_end_time,
      </if>
      <if test="skuStatus != null">
        sku_status,
      </if>
      <if test="onSale != null">
        on_sale,
      </if>
      <if test="companyCode != null">
        company_code,
      </if>
      <if test="companyName != null">
        company_name,
      </if>
      <if test="applyCode != null">
        apply_code,
      </if>
      <if test="applyStatus != null">
        apply_status,
      </if>
      <if test="auditorBy != null">
        auditor_by,
      </if>
      <if test="auditorTime != null">
        auditor_time,
      </if>
      <if test="delFlag != null">
        del_flag,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
      <if test="createBy != null">
        create_by,
      </if>
      <if test="updateTime != null">
        update_time,
      </if>
      <if test="updateBy != null">
        update_by,
      </if>
      <if test="spec != null">
        spec,
      </if>
      <if test="unitName != null">
        unit_name,
      </if>
      <if test="unitCode != null">
        unit_code,
      </if>
      <if test="boxGauge != null">
        box_gauge,
      </if>
      <if test="point != null">
        point,
      </if>
      <if test="spuCode != null">
        spu_code,
      </if>
      <if test="barCode != null">
        bar_code,
      </if>
      <if test="logo != null">
        logo,
      </if>
      <if test="images != null">
        images,
      </if>
      <if test="itroImages != null">
        itro_images,
      </if>
      <if test="zeroRemovalCoefficient != null">
        zero_removal_coefficient,
      </if>
      <if test="useTime != null">
        use_time,
      </if>
      <if test="uniqueCode != null">
        unique_code,
      </if>
      <if test="inventoryModel != null">
        inventory_model,
      </if>
      <if test="inventoryAllocation != null">
        inventory_allocation,
      </if>
      <if test="priceModel != null">
        price_model,
      </if>
      <if test="productDesc != null">
        product_desc,
      </if>
      <if test="itemNumber != null">
         item_number,
      </if>
      <if test="seasonBand != null">
          season_band,
      </if>
      <if test="level != null">
         `level`,
      </if>
      <if test="featureCode != null">
          feature_code,
      </if>
      <if test="featureName != null">
          feature_name,
      </if>
      <if test="currencyLevelCode != null">
          currency_level_code,
      </if>
      <if test="currencyLevelCode != null">
          currency_level_name
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=BIGINT},
      </if>
      <if test="skuCode != null">
        #{skuCode,jdbcType=VARCHAR},
      </if>
      <if test="skuName != null">
        #{skuName,jdbcType=VARCHAR},
      </if>
      <if test="skuAbbreviation != null">
        #{skuAbbreviation,jdbcType=VARCHAR},
      </if>
      <if test="productCode != null">
        #{productCode,jdbcType=VARCHAR},
      </if>
      <if test="productName != null">
        #{productName,jdbcType=VARCHAR},
      </if>
      <if test="productBrandCode != null">
        #{productBrandCode,jdbcType=VARCHAR},
      </if>
      <if test="productBrandName != null">
        #{productBrandName,jdbcType=VARCHAR},
      </if>
      <if test="productCategoryCode != null">
        #{productCategoryCode,jdbcType=VARCHAR},
      </if>
      <if test="productCategoryName != null">
        #{productCategoryName,jdbcType=VARCHAR},
      </if>
      <if test="goodsGifts != null">
        #{goodsGifts,jdbcType=TINYINT},
      </if>
      <if test="productPropertyCode != null">
        #{productPropertyCode,jdbcType=VARCHAR},
      </if>
      <if test="productPropertyName != null">
        #{productPropertyName,jdbcType=VARCHAR},
      </if>
      <if test="productSortCode != null">
        #{productSortCode,jdbcType=VARCHAR},
      </if>
      <if test="productSortName != null">
        #{productSortName,jdbcType=VARCHAR},
      </if>
      <if test="procurementSectionCode != null">
        #{procurementSectionCode,jdbcType=VARCHAR},
      </if>
      <if test="procurementSectionName != null">
        #{procurementSectionName,jdbcType=VARCHAR},
      </if>
      <if test="colorCode != null">
        #{colorCode,jdbcType=VARCHAR},
      </if>
      <if test="colorName != null">
        #{colorName,jdbcType=VARCHAR},
      </if>
      <if test="modelNumber != null">
        #{modelNumber,jdbcType=VARCHAR},
      </if>
      <if test="managementStyleCode != null">
        #{managementStyleCode,jdbcType=VARCHAR},
      </if>
      <if test="managementStyleName != null">
        #{managementStyleName,jdbcType=VARCHAR},
      </if>
      <if test="qualityAssuranceManagement != null">
        #{qualityAssuranceManagement,jdbcType=TINYINT},
      </if>
      <if test="qualityNumber != null">
        #{qualityNumber,jdbcType=VARCHAR},
      </if>
      <if test="qualityDate != null">
        #{qualityDate,jdbcType=VARCHAR},
      </if>
      <if test="categoriesSupplyChannelsCode != null">
        #{categoriesSupplyChannelsCode,jdbcType=VARCHAR},
      </if>
      <if test="categoriesSupplyChannelsName != null">
        #{categoriesSupplyChannelsName,jdbcType=VARCHAR},
      </if>
      <if test="seasonalGoods != null">
        #{seasonalGoods,jdbcType=TINYINT},
      </if>
      <if test="structuralGoods != null">
        #{structuralGoods,jdbcType=TINYINT},
      </if>
      <if test="manufacturerGuidePrice != null">
        #{manufacturerGuidePrice,jdbcType=DECIMAL},
      </if>
      <if test="applicableMonthAge != null">
        #{applicableMonthAge,jdbcType=VARCHAR},
      </if>
      <if test="mnemonicCode != null">
        #{mnemonicCode,jdbcType=VARCHAR},
      </if>
      <if test="warehouseTypeCode != null">
        #{warehouseTypeCode,jdbcType=VARCHAR},
      </if>
      <if test="warehouseTypeName != null">
        #{warehouseTypeName,jdbcType=VARCHAR},
      </if>
      <if test="isMainPush != null">
        #{isMainPush,jdbcType=TINYINT},
      </if>
      <if test="newProduct != null">
        #{newProduct,jdbcType=TINYINT},
      </if>
      <if test="remark != null">
        #{remark,jdbcType=VARCHAR},
      </if>
      <if test="selectionEffectiveTime != null">
        #{selectionEffectiveTime,jdbcType=TINYINT},
      </if>
      <if test="selectionEffectiveStartTime != null">
        #{selectionEffectiveStartTime,jdbcType=VARCHAR},
      </if>
      <if test="selectionEffectiveEndTime != null">
        #{selectionEffectiveEndTime,jdbcType=VARCHAR},
      </if>
      <if test="skuStatus != null">
        #{skuStatus,jdbcType=TINYINT},
      </if>
      <if test="onSale != null">
        #{onSale,jdbcType=TINYINT},
      </if>
      <if test="companyCode != null">
        #{companyCode,jdbcType=VARCHAR},
      </if>
      <if test="companyName != null">
        #{companyName,jdbcType=VARCHAR},
      </if>
      <if test="applyCode != null">
        #{applyCode,jdbcType=VARCHAR},
      </if>
      <if test="applyStatus != null">
        #{applyStatus,jdbcType=TINYINT},
      </if>
      <if test="auditorBy != null">
        #{auditorBy,jdbcType=VARCHAR},
      </if>
      <if test="auditorTime != null">
        #{auditorTime,jdbcType=TIMESTAMP},
      </if>
      <if test="delFlag != null">
        #{delFlag,jdbcType=TINYINT},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createBy != null">
        #{createBy,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null">
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateBy != null">
        #{updateBy,jdbcType=VARCHAR},
      </if>
      <if test="spec != null">
        #{spec,jdbcType=VARCHAR},
      </if>
      <if test="unitName != null">
        #{unitName,jdbcType=VARCHAR},
      </if>
      <if test="unitCode != null">
        #{unitCode,jdbcType=VARCHAR},
      </if>
      <if test="boxGauge != null">
        #{boxGauge,jdbcType=VARCHAR},
      </if>
      <if test="point != null">
        #{point,jdbcType=VARCHAR},
      </if>
      <if test="spuCode != null">
        #{spuCode,jdbcType=VARCHAR},
      </if>
      <if test="barCode != null">
        #{barCode,jdbcType=VARCHAR},
      </if>
      <if test="logo != null">
        #{logo,jdbcType=VARCHAR},
      </if>
      <if test="images != null">
        #{images,jdbcType=VARCHAR},
      </if>
      <if test="itroImages != null">
        #{itroImages,jdbcType=VARCHAR},
      </if>
      <if test="zeroRemovalCoefficient != null">
        #{zeroRemovalCoefficient,jdbcType=BIGINT},
      </if>
      <if test="useTime != null">
        #{useTime,jdbcType=INTEGER},
      </if>
      <if test="uniqueCode != null">
        #{uniqueCode,jdbcType=TINYINT},
      </if>
      <if test="inventoryModel != null">
        #{inventoryModel,jdbcType=TINYINT},
      </if>
      <if test="inventoryAllocation != null">
        #{inventoryAllocation,jdbcType=TINYINT},
      </if>
      <if test="priceModel != null">
        #{priceModel,jdbcType=TINYINT},
      </if>
        <if test="productDesc != null">
        #{productDesc,jdbcType=VARCHAR},
      </if>
      <if test="itemNumber != null">
        #{itemNumber,jdbcType=VARCHAR},
      </if>
      <if test="seasonBand != null">
          #{seasonBand,jdbcType=VARCHAR},
      </if>
      <if test="level != null">
          #{level,jdbcType=VARCHAR},
      </if>
      <if test="featureCode != null">
          #{featureCode,jdbcType=VARCHAR}
      </if>
      <if test="featureName != null">
          #{featureName,jdbcType=VARCHAR},
      </if>
      <if test="currencyLevelCode != null">
          #{currencyLevelCode,jdbcType=VARCHAR},
      </if>
      <if test="currencyLevelCode != null">
          #{currencyLevelName,jdbcType=VARCHAR}
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuInfo">
    update product_sku
    <set>
      <if test="skuCode != null">
        sku_code = #{skuCode,jdbcType=VARCHAR},
      </if>
      <if test="skuName != null">
        sku_name = #{skuName,jdbcType=VARCHAR},
      </if>
      <if test="skuAbbreviation != null">
        sku_abbreviation = #{skuAbbreviation,jdbcType=VARCHAR},
      </if>
      <if test="productCode != null">
        product_code = #{productCode,jdbcType=VARCHAR},
      </if>
      <if test="productName != null">
        product_name = #{productName,jdbcType=VARCHAR},
      </if>
      <if test="productBrandCode != null">
        product_brand_code = #{productBrandCode,jdbcType=VARCHAR},
      </if>
      <if test="productBrandName != null">
        product_brand_name = #{productBrandName,jdbcType=VARCHAR},
      </if>
      <if test="productCategoryCode != null">
        product_category_code = #{productCategoryCode,jdbcType=VARCHAR},
      </if>
      <if test="productCategoryName != null">
        product_category_name = #{productCategoryName,jdbcType=VARCHAR},
      </if>
      <if test="goodsGifts != null">
        goods_gifts = #{goodsGifts,jdbcType=TINYINT},
      </if>
      <if test="productPropertyCode != null">
        product_property_code = #{productPropertyCode,jdbcType=VARCHAR},
      </if>
      <if test="productPropertyName != null">
        product_property_name = #{productPropertyName,jdbcType=VARCHAR},
      </if>
      <if test="productSortCode != null">
        product_sort_code = #{productSortCode,jdbcType=VARCHAR},
      </if>
      <if test="productSortName != null">
        product_sort_name = #{productSortName,jdbcType=VARCHAR},
      </if>
      <if test="procurementSectionCode != null">
        procurement_section_code = #{procurementSectionCode,jdbcType=VARCHAR},
      </if>
      <if test="procurementSectionName != null">
        procurement_section_name = #{procurementSectionName,jdbcType=VARCHAR},
      </if>
      <if test="colorCode != null">
        color_code = #{colorCode,jdbcType=VARCHAR},
      </if>
      <if test="colorName != null">
        color_name = #{colorName,jdbcType=VARCHAR},
      </if>
      <if test="modelNumber != null">
        model_number = #{modelNumber,jdbcType=VARCHAR},
      </if>
      <if test="managementStyleCode != null">
        management_style_code = #{managementStyleCode,jdbcType=VARCHAR},
      </if>
      <if test="managementStyleName != null">
        management_style_name = #{managementStyleName,jdbcType=VARCHAR},
      </if>
      <if test="qualityAssuranceManagement != null">
        quality_assurance_management = #{qualityAssuranceManagement,jdbcType=TINYINT},
      </if>
      <if test="qualityNumber != null">
        quality_number = #{qualityNumber,jdbcType=VARCHAR},
      </if>
      <if test="qualityDate != null">
        quality_date = #{qualityDate,jdbcType=VARCHAR},
      </if>
      <if test="categoriesSupplyChannelsCode != null">
        categories_supply_channels_code = #{categoriesSupplyChannelsCode,jdbcType=VARCHAR},
      </if>
      <if test="categoriesSupplyChannelsName != null">
        categories_supply_channels_name = #{categoriesSupplyChannelsName,jdbcType=VARCHAR},
      </if>
      <if test="seasonalGoods != null">
        seasonal_goods = #{seasonalGoods,jdbcType=TINYINT},
      </if>
      <if test="structuralGoods != null">
        structural_goods = #{structuralGoods,jdbcType=TINYINT},
      </if>
      <if test="manufacturerGuidePrice != null">
        manufacturer_guide_price = #{manufacturerGuidePrice,jdbcType=DECIMAL},
      </if>
      <if test="applicableMonthAge != null">
        applicable_month_age = #{applicableMonthAge,jdbcType=VARCHAR},
      </if>
      <if test="mnemonicCode != null">
        mnemonic_code = #{mnemonicCode,jdbcType=VARCHAR},
      </if>
      <if test="warehouseTypeCode != null">
        warehouse_type_code = #{warehouseTypeCode,jdbcType=VARCHAR},
      </if>
      <if test="warehouseTypeName != null">
        warehouse_type_name = #{warehouseTypeName,jdbcType=VARCHAR},
      </if>
      <if test="isMainPush != null">
        is_main_push = #{isMainPush,jdbcType=TINYINT},
      </if>
      <if test="newProduct != null">
        new_product = #{newProduct,jdbcType=TINYINT},
      </if>
      <if test="remark != null">
        remark = #{remark,jdbcType=VARCHAR},
      </if>
      <if test="selectionEffectiveTime != null">
        selection_effective_time = #{selectionEffectiveTime,jdbcType=TINYINT},
      </if>
      <if test="selectionEffectiveStartTime != null">
        selection_effective_start_time = #{selectionEffectiveStartTime,jdbcType=VARCHAR},
      </if>
      <if test="selectionEffectiveEndTime != null">
        selection_effective_end_time = #{selectionEffectiveEndTime,jdbcType=VARCHAR},
      </if>
      <if test="skuStatus != null">
        sku_status = #{skuStatus,jdbcType=TINYINT},
      </if>
      <if test="onSale != null">
        on_sale = #{onSale,jdbcType=TINYINT},
      </if>
      <if test="companyCode != null">
        company_code = #{companyCode,jdbcType=VARCHAR},
      </if>
      <if test="companyName != null">
        company_name = #{companyName,jdbcType=VARCHAR},
      </if>
      <if test="applyCode != null">
        apply_code = #{applyCode,jdbcType=VARCHAR},
      </if>
      <if test="applyStatus != null">
        apply_status = #{applyStatus,jdbcType=TINYINT},
      </if>
      <if test="auditorBy != null">
        auditor_by = #{auditorBy,jdbcType=VARCHAR},
      </if>
      <if test="auditorTime != null">
        auditor_time = #{auditorTime,jdbcType=TIMESTAMP},
      </if>
      <if test="delFlag != null">
        del_flag = #{delFlag,jdbcType=TINYINT},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createBy != null">
        create_by = #{createBy,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null">
        update_time = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateBy != null">
        update_by = #{updateBy,jdbcType=VARCHAR},
      </if>
      <if test="spec != null">
        spec = #{spec,jdbcType=VARCHAR},
      </if>
      <if test="unitName != null">
        unit_name = #{unitName,jdbcType=VARCHAR},
      </if>
      <if test="unitCode != null">
        unit_code = #{unitCode,jdbcType=VARCHAR},
      </if>
      <if test="boxGauge != null">
        box_gauge = #{boxGauge,jdbcType=VARCHAR},
      </if>
      <if test="point != null">
        point = #{point,jdbcType=VARCHAR},
      </if>
      <if test="spuCode != null">
        spu_code = #{spuCode,jdbcType=VARCHAR},
      </if>
      <if test="barCode != null">
        bar_code = #{barCode,jdbcType=VARCHAR},
      </if>
      <if test="logo != null">
        logo = #{logo,jdbcType=VARCHAR},
      </if>
      <if test="images != null">
        images = #{images,jdbcType=VARCHAR},
      </if>
      <if test="itroImages != null">
        itro_images = #{itroImages,jdbcType=VARCHAR},
      </if>
      <if test="zeroRemovalCoefficient != null">
        zero_removal_coefficient = #{zeroRemovalCoefficient,jdbcType=BIGINT},
      </if>
      <if test="useTime != null">
        use_time = #{useTime,jdbcType=INTEGER},
      </if>
      <if test="uniqueCode != null">
        unique_code = #{uniqueCode,jdbcType=TINYINT},
      </if>
      <if test="inventoryModel != null">
        inventory_model = #{inventoryModel,jdbcType=TINYINT},
      </if>
      <if test="inventoryAllocation != null">
        inventory_allocation = #{inventoryAllocation,jdbcType=TINYINT},
      </if>
      <if test="priceModel != null">
        price_model = #{priceModel,jdbcType=TINYINT},
      </if>
      <if test="productDesc != null">
        product_desc = #{productDesc,jdbcType=VARCHAR},
      </if>
      <if test="itemNumber != null">
          item_number = #{itemNumber,jdbcType=VARCHAR},
      </if>
      <if test="seasonBand != null">
          season_band = #{seasonBand,jdbcType=VARCHAR},
      </if>
      <if test="level != null">
          `level` = #{level,jdbcType=VARCHAR},
      </if>
      <if test="featureCode != null">
          feature_code = #{featureCode,jdbcType=VARCHAR},
      </if>
      <if test="featureName != null">
          feature_name = #{featureName,jdbcType=VARCHAR},
      </if>
      <if test="currencyLevelCode != null">
          currency_level_code = #{currencyLevelCode,jdbcType=VARCHAR},
      </if>
      <if test="currencyLevelCode != null">
          currency_level_code = #{currencyLevelName,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuInfo">
    update product_sku
    set sku_code = #{skuCode,jdbcType=VARCHAR},
      sku_name = #{skuName,jdbcType=VARCHAR},
      sku_abbreviation = #{skuAbbreviation,jdbcType=VARCHAR},
      product_code = #{productCode,jdbcType=VARCHAR},
      product_name = #{productName,jdbcType=VARCHAR},
      product_brand_code = #{productBrandCode,jdbcType=VARCHAR},
      product_brand_name = #{productBrandName,jdbcType=VARCHAR},
      product_category_code = #{productCategoryCode,jdbcType=VARCHAR},
      product_category_name = #{productCategoryName,jdbcType=VARCHAR},
      goods_gifts = #{goodsGifts,jdbcType=TINYINT},
      product_property_code = #{productPropertyCode,jdbcType=VARCHAR},
      product_property_name = #{productPropertyName,jdbcType=VARCHAR},
      product_sort_code = #{productSortCode,jdbcType=VARCHAR},
      product_sort_name = #{productSortName,jdbcType=VARCHAR},
      procurement_section_code = #{procurementSectionCode,jdbcType=VARCHAR},
      procurement_section_name = #{procurementSectionName,jdbcType=VARCHAR},
      color_code = #{colorCode,jdbcType=VARCHAR},
      color_name = #{colorName,jdbcType=VARCHAR},
      model_number = #{modelNumber,jdbcType=VARCHAR},
      management_style_code = #{managementStyleCode,jdbcType=VARCHAR},
      management_style_name = #{managementStyleName,jdbcType=VARCHAR},
      quality_assurance_management = #{qualityAssuranceManagement,jdbcType=TINYINT},
      quality_number = #{qualityNumber,jdbcType=VARCHAR},
      quality_date = #{qualityDate,jdbcType=VARCHAR},
      categories_supply_channels_code = #{categoriesSupplyChannelsCode,jdbcType=VARCHAR},
      categories_supply_channels_name = #{categoriesSupplyChannelsName,jdbcType=VARCHAR},
      seasonal_goods = #{seasonalGoods,jdbcType=TINYINT},
      structural_goods = #{structuralGoods,jdbcType=TINYINT},
      manufacturer_guide_price = #{manufacturerGuidePrice,jdbcType=DECIMAL},
      applicable_month_age = #{applicableMonthAge,jdbcType=VARCHAR},
      mnemonic_code = #{mnemonicCode,jdbcType=VARCHAR},
      warehouse_type_code = #{warehouseTypeCode,jdbcType=VARCHAR},
      warehouse_type_name = #{warehouseTypeName,jdbcType=VARCHAR},
      is_main_push = #{isMainPush,jdbcType=TINYINT},
      new_product = #{newProduct,jdbcType=TINYINT},
      remark = #{remark,jdbcType=VARCHAR},
      selection_effective_time = #{selectionEffectiveTime,jdbcType=TINYINT},
      selection_effective_start_time = #{selectionEffectiveStartTime,jdbcType=VARCHAR},
      selection_effective_end_time = #{selectionEffectiveEndTime,jdbcType=VARCHAR},
      sku_status = #{skuStatus,jdbcType=TINYINT},
      on_sale = #{onSale,jdbcType=TINYINT},
      company_code = #{companyCode,jdbcType=VARCHAR},
      company_name = #{companyName,jdbcType=VARCHAR},
      apply_code = #{applyCode,jdbcType=VARCHAR},
      apply_status = #{applyStatus,jdbcType=TINYINT},
      auditor_by = #{auditorBy,jdbcType=VARCHAR},
      auditor_time = #{auditorTime,jdbcType=TIMESTAMP},
      del_flag = #{delFlag,jdbcType=TINYINT},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      create_by = #{createBy,jdbcType=VARCHAR},
      update_time = #{updateTime,jdbcType=TIMESTAMP},
      update_by = #{updateBy,jdbcType=VARCHAR},
      spec = #{spec,jdbcType=VARCHAR},
      unit_name = #{unitName,jdbcType=VARCHAR},
      unit_code = #{unitCode,jdbcType=VARCHAR},
      box_gauge = #{boxGauge,jdbcType=VARCHAR},
      point = #{point,jdbcType=VARCHAR},
      spu_code = #{spuCode,jdbcType=VARCHAR},
      bar_code = #{barCode,jdbcType=VARCHAR},
      logo = #{logo,jdbcType=VARCHAR},
      images = #{images,jdbcType=VARCHAR},
      itro_images = #{itroImages,jdbcType=VARCHAR},
      zero_removal_coefficient = #{zeroRemovalCoefficient,jdbcType=BIGINT},
      use_time = #{useTime,jdbcType=INTEGER},
      unique_code = #{uniqueCode,jdbcType=TINYINT},
      inventory_model = #{inventoryModel,jdbcType=TINYINT},
      inventory_allocation = #{inventoryAllocation,jdbcType=TINYINT},
      price_model = #{priceModel,jdbcType=TINYINT},
      product_desc = #{productDesc,jdbcType=VARCHAR}
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateStatus" parameterType="java.util.List">
    <foreach collection="list" item="item" separator=";">
      update product_sku
      set sku_status = #{item.skuStatus},
      on_sale = #{item.onSale}
      where sku_code = #{item.skuCode}
    </foreach>
  </update>
    <select id="checkName" resultType="java.lang.Integer">
      select count(*) from
        product_sku
       where 1=1
        <if test="skuCode != null and skuCode != '' ">
            and sku_code != #{skuCode}
        </if>
        <!--<if test="skuName != null and skuName != '' ">-->
            <!--and sku_name = #{skuName}-->
        <!--</if>-->
    </select>
</mapper>