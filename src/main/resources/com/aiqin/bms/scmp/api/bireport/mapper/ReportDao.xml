<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiqin.bms.scmp.api.bireport.dao.ReportDao">

    <select id="selectSupplierArrivalRate" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.SupplierArrivalRateReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.SupplierArrivalRateRespVo">
        select
        #{beginInboundTime}  as beginInboundTime,
        #{finishInboundTime} as finishInboundTime,
        bsar.supplier_code as supplierCode,
        bsar.supplier_name as supplierName,
        bsar.category_level_code as categoryLevelCode,
        bsar.category_level_name as categoryLevelName,
        bsar.logistics_center_code as transportCenterCode,
        bsar.pre_inbound_num as preInboundNum,
        bsar.pre_tax_amount as preTaxAmount,
        bsar.pra_inbound_num as praInboundNum,
        bsar.pra_tax_amount as praTaxAmount,
        bsar.pra_tax_amount_rate as praTaxAmountRate,
        bsar.responsible_person_name as responsiblePersonName
        from bi_supplier_arrival_rate bsar
        where 1=1
        <if test="supplierCode!=null and supplierCode!=''">
            and bsar.supplier_code=#{supplierCode}
        </if>
        <if test="supplierName!=null and supplierName!=''">
            and bsar.supplier_name like concat('%', #{supplierName}, '%')
        </if>
        <if test="transportCenterCode!=null and transportCenterCode!=''">
            and bsar.logistics_center_code=#{transportCenterCode}
        </if>
        <if test="categoryLevelCode!=null and categoryLevelCode!=''">
            and bsar.category_level_code=#{categoryLevelCode}
        </if>
        <if test="categoryLevelName!=null and categoryLevelName!=''">
            and bsar.category_level_name like concat('%', #{categoryLevelName}, '%')
        </if>
        <if test="beginInboundTime!=null and beginInboundTime!=''">
            and bsar.inbound_time between #{beginInboundTime}
        </if>
        <if test="finishInboundTime!=null and finishInboundTime!=''">
            and #{finishInboundTime}
        </if>

    </select>
    <select id="selectGoodsBuySales" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.GoodsBuySalesReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.GoodsBuySalesRespVo">
        select
        #{beginCreateTime}  as beginCreateTime,
        #{finishCreateTime} as finishCreateTime,
        bgbs.supplier_code as supplierCode,
        bgbs.supplier_name as supplierName,
        bgbs.sku_code as skuCode,
        bgbs.sku_name as skuName,
        bgbs.batch_code as batchCode,
        bgbs.product_sort_code as productSortCode,
        bgbs.product_sort_name as productSortName,
        bgbs.transport_center_code as transportCenterCode,
        bgbs.transport_center_name as transportCenterName,
        bgbs.warehouse_code as warehouseCode,
        bgbs.warehouse_name as warehouseName,
        bgbs.category_name as productCategoryName,
        bgbs.product_category_code as productCategoryCode,
        bgbs.product_category_one as productCategoryOne,
        bgbs.product_category_two as productCategoryTwo,
        bgbs.product_category_three as productCategoryThree,
        bgbs.product_category_four as productCategoryFour,
        bgbs.product_brand_code as productBrandCode,
        bgbs.product_brand_name as productBrandName,
        bgbs.manufacturer_guide_price as manufacturerGuidePrice,
        bgbs.inventory_num as inventoryNum,
        bgbs.tax_cost as taxCost,
        bgbs.sales_num_one_month as salesNumOneMonth,
        bgbs.sales_cost_one_month as salesCostOneMonth,
        bgbs.fen_sales_money_one_month as fenSalesMoneyOneMonth,
        bgbs.fen_sales_maori_one_month as fenSalesMaoriOneMonth,
        bgbs.fen_sales_maori_one_month_rate as fenSalesMaoriOneMonthRate,
        bgbs.qun_sales_money_one_month as qunSalesMoneyOneMonth,
        bgbs.qun_sales_maori_one_month as qunSalesMaoriOneMonth,
        bgbs.qun_sales_maori_one_month_rate as qunSalesMaoriOneMonthRate,
        bgbs.turnover_days as turnoverDays,
        bgbs.create_time as createTime,
        bgbs.inbound_days as inboundDays,
        bgbs.config_status as configStatus,
        bgbs.responsible_person_code as responsiblePersonCode,
        bgbs.responsible_person_name as responsiblePersonName,
        bgbs.production_date as productionDate,
        bgbs.quality_number as qualityNumber
        from bi_goods_buy_sales bgbs
        where 1=1
        <if test="supplierCode!=null and supplierCode!=''">
            and bgbs.supplier_code=#{supplierCode}
        </if>
        <if test="supplierName!=null and supplierName!=''">
            and bgbs.supplier_name like concat('%', #{supplierName}, '%')
        </if>
        <if test="skuCode!=null and skuCode!=''">
            and bgbs.sku_code=#{skuCode}
        </if>
        <if test="skuName!=null and skuName!=''">
            and bgbs.sku_name like concat('%', #{skuName}, '%')
        </if>
        <if test="transportCenterCode!=null and transportCenterCode!=''">
            and bgbs.transport_center_code=#{transportCenterCode}
        </if>
        <if test="transportCenterName!=null and transportCenterName!=''">
            and bgbs.transport_center_name like concat('%', #{transportCenterName}, '%')
        </if>
        <if test="productCategoryName!=null and productCategoryName!=''">
            and bgbs.category_name like concat('%', #{productCategoryName}, '%')
        </if>
        <if test="productCategoryCode!=null and productCategoryCode!=''">
            and bgbs.product_category_code=#{productCategoryCode}
        </if>
        <if test="productSortCode!=null and productSortCode!=''">
            and bgbs.product_sort_code=#{productSortCode}
        </if>
        <if test="productSortName!=null and productSortName!=''">
            and bgbs.product_sort_name like concat('%', #{productSortName}, '%')
        </if>
        <if test="beginCreateTime!=null and beginCreateTime!=''">
            and bgbs.create_time between #{beginCreateTime}
        </if>
        <if test="finishCreateTime!=null and finishCreateTime!=''">
            and #{finishCreateTime}
        </if>
        <if test="inboundDays!=null and inboundDays!=''">
            and bgbs.inbound_days=#{inboundDays}
        </if>
        <if test="beginTurnoverDays!=null">
            and bgbs.turnover_days <![CDATA[>=]]> #{beginTurnoverDays}
        </if>
        <if test="finishTurnoverDays!=null">
            and bgbs.turnover_days <![CDATA[<=]]> #{finishTurnoverDays}
        </if>
        <if test="warehouseCode!=null and warehouseCode!=''">
            and bgbs.warehouse_code=#{warehouseCode}
        </if>
        <if test="warehouseName!=null and warehouseName!=''">
            and bgbs.warehouse_name like concat('%', #{warehouseName}, '%')
        </if>
        <if test="productCategoryOne!=null and productCategoryOne!=''">
            and bgbs.product_category_one like concat('%', #{productCategoryOne}, '%')
        </if>
        <if test="productCategoryTwo!=null and productCategoryTwo!=''">
            and bgbs.product_category_two like concat('%', #{productCategoryTwo}, '%')
        </if>
        <if test="productCategoryThree!=null and productCategoryThree!=''">
            and bgbs.product_category_three like concat('%', #{productCategoryThree}, '%')
        </if>
        <if test="productCategoryFour!=null and productCategoryFour!=''">
            and bgbs.product_category_four like concat('%', #{productCategoryFour}, '%')
        </if>
    </select>
    <select id="selectGiftsBuySales" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.GiftsBuySalesReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.GiftsBuySalesRespVo">
        select
        bgbs.sku_code as skuCode,
        bgbs.sku_name as skuName,
        #{beginCreateTime}  as beginCreateTime,
        #{finishCreateTime} as finishCreateTime,
        bgbs.category_name as productCategoryName,
        bgbs.product_category_code as productCategoryCode,
        bgbs.product_category_one as productCategoryOne,
        bgbs.product_category_two as productCategoryTwo,
        bgbs.product_category_three as productCategoryThree,
        bgbs.product_category_four as productCategoryFour,
        bgbs.product_sort_code as productSortCode,
        bgbs.product_sort_name as productSortName,
        bgbs.product_brand_code as productBrandCode,
        bgbs.product_brand_name as productBrandName,
        bgbs.manufacturer_guide_price as manufacturerGuidePrice,
        bgbs.transport_center_code as transportCenterCode,
        bgbs.transport_center_name as transportCenterName,
        bgbs.warehouse_code as warehouseCode,
        bgbs.warehouse_name as warehouseName,
        bgbs.inventory_num as inventoryNum,
        bgbs.sales_num_one_month as salesNumOneMonth,
        bgbs.sales_money_one_month as salesMoneyOneMonth,
        bgbs.turnover_days as turnoverDays,
        bgbs.create_time as createTime,
        bgbs.inbound_days as inboundDays,
        bgbs.responsible_person_code as responsiblePersonCode,
        bgbs.responsible_person_name as responsiblePersonName
        from bi_gifts_buy_sales bgbs
        where 1=1
        <if test="skuCode!=null and skuCode!=''">
            and bgbs.sku_code=#{skuCode}
        </if>
        <if test="skuName!=null and skuName!=''">
            and bgbs.sku_name like concat('%', #{skuName}, '%')
        </if>
        <if test="transportCenterCode!=null and transportCenterCode!=''">
            and bgbs.transport_center_code=#{transportCenterCode}
        </if>
        <if test="transportCenterName!=null and transportCenterName!=''">
            and bgbs.transport_center_name like concat('%', #{transportCenterName}, '%')
        </if>
        <if test="inboundDays!=null and inboundDays!=''">
            and bgbs.inbound_days=#{inboundDays}
        </if>
        <if test="productSortCode!=null and productSortCode!=''">
            and bgbs.product_sort_code=#{productSortCode}
        </if>
        <if test="productSortName!=null and productSortName!=''">
            and bgbs.product_sort_name like concat('%', #{productSortName}, '%')
        </if>
        <if test="beginCreateTime!=null and beginCreateTime!=''">
            and bgbs.create_time between #{beginCreateTime}
        </if>
        <if test="finishCreateTime!=null and finishCreateTime!=''">
            and #{finishCreateTime}
        </if>
        <if test="warehouseCode!=null and warehouseCode!=''">
            and bgbs.warehouse_code=#{warehouseCode}
        </if>
        <if test="warehouseName!=null and warehouseName!=''">
            and bgbs.warehouse_name like concat('%', #{warehouseName}, '%')
        </if>
        <if test="beginTurnoverDays!=null">
            and bgbs.turnover_days <![CDATA[>=]]> #{beginTurnoverDays}
        </if>
        <if test="finishTurnoverDays!=null">
            and bgbs.turnover_days <![CDATA[<=]]> #{finishTurnoverDays}
        </if>
        <if test="productCategoryOne!=null and productCategoryOne!=''">
            and bgbs.product_category_one like concat('%', #{productCategoryOne}, '%')
        </if>
        <if test="productCategoryTwo!=null and productCategoryTwo!=''">
            and bgbs.product_category_two like concat('%', #{productCategoryTwo}, '%')
        </if>
        <if test="productCategoryThree!=null and productCategoryThree!=''">
            and bgbs.product_category_three like concat('%', #{productCategoryThree}, '%')
        </if>
        <if test="productCategoryFour!=null and productCategoryFour!=''">
            and bgbs.product_category_four like concat('%', #{productCategoryFour}, '%')
        </if>
    </select>
    <select id="selectSupplierReturn" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.SupplierReturnReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.SupplierReturnRespVo">
        select
        bsr.id as id,
        bsr.supplier_code as supplierCode,
        bsr.supplier_name as supplierName,
        bsr.transport_center_code as transportCenterCode,
        bsr.transport_center_name as transportCenterName,
        bsr.warehouse_code as warehouseCode,
        bsr.warehouse_name as warehouseName,
        bsr.reject_record_code as rejectRecordCode,
        bsr.sum_count as sumCount,
        bsr.sum_amount as sumAmount,
        bsr.create_time as createTime,
        bsr.out_stock_time as outStockTime,
        bsr.reject_status as rejectStatus,
        bsr.purchase_group_code as purchaseGroupCode,
        bsr.purchase_group_name as purchaseGroupName,
        bsr.responsible_person_code as responsiblePersonCode,
        bsr.responsible_person_name as responsiblePersonName
        from bi_supplier_return bsr
        where 1=1
        <if test="supplierCode!=null and supplierCode!=''">
            and bsr.supplier_code=#{supplierCode}
        </if>
        <if test="supplierName!=null and supplierName!=''">
            and bsr.supplier_name like concat('%', #{supplierName}, '%')
        </if>
        <if test="transportCenterCode!=null and transportCenterCode!=''">
            and bsr.transport_center_code=#{transportCenterCode}
        </if>
        <if test="transportCenterName!=null and transportCenterName!=''">
            and bsr.transport_center_name like concat('%', #{transportCenterName}, '%')
        </if>
        <if test="warehouseCode!=null and warehouseCode!=''">
            and bsr.warehouse_code=#{warehouseCode}
        </if>
        <if test="warehouseName!=null and warehouseName!=''">
            and bsr.warehouse_name like concat('%', #{warehouseName}, '%')
        </if>
        <if test="beginCreateTime!=null and beginCreateTime!=''">
            and bsr.create_time between #{beginCreateTime}
        </if>
        <if test="finishCreateTime!=null and finishCreateTime!=''">
            and #{finishCreateTime}
        </if>

    </select>
    <select id="selectNewProductBatchMovingRate" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.NewProductBatchMovingRateReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.NewProductBatchMovingRateRespVo">
        select
        bnpbmr.id as id,
        bnpbmr.sku_code as skuCode,
        bnpbmr.sku_name as skuName,
        bnpbmr.batch_code as batchCode,
        bnpbmr.supplier_code as supplierCode,
        bnpbmr.supplier_name as supplierName,
        bnpbmr.product_sort_code as productSortCode,
        bnpbmr.product_sort_name as productSortName,
        bnpbmr.product_category_code as productCategoryCode,
        bnpbmr.product_category_one as productCategoryOne,
        bnpbmr.product_category_two as productCategoryTwo,
        bnpbmr.product_category_three as productCategoryThree,
        bnpbmr.product_category_four as productCategoryFour,
        bnpbmr.product_brand_code as productBrandCode,
        bnpbmr.product_brand_name as productBrandName,
        bnpbmr.purchase_price as purchasePrice,
        bnpbmr.manufacturer_guide_price as manufacturerGuidePrice,
        bnpbmr.inventory_num as inventoryNum,
        bnpbmr.tax_cost as taxCost,
        bnpbmr.price_channel_name as priceChannelName,
        bnpbmr.num as num,
        bnpbmr.sales_costs as salesCosts,
        bnpbmr.qun_amount as qunAmount,
        bnpbmr.qun_maori as qunMaori,
        bnpbmr.qun_maori_rate as qunMaoriRate,
        bnpbmr.fen_amount as fenAmount,
        bnpbmr.fen_maori as fenMaori,
        bnpbmr.fen_maori_rate as fenMaoriRate,
        bnpbmr.sales_num_one_month as salesNumOneMonth,
        bnpbmr.sales_cost_one_month as salesCostOneMonth,
        bnpbmr.turnover_days as turnoverDays,
        bnpbmr.create_time as createTime,
        bnpbmr.inbound_days as inboundDays,
        bnpbmr.config_status as configStatus,
        bnpbmr.responsible_person_code as responsiblePersonCode,
        bnpbmr.responsible_person_name as responsiblePersonName
        from bi_new_product_batch_moving_rate bnpbmr
        where 1=1
        <if test="skuCode!=null and skuCode!=''">
            and bnpbmr.sku_code=#{skuCode}
        </if>
        <if test="skuName!=null and skuName!=''">
            and bnpbmr.sku_name like concat('%', #{skuName}, '%')
        </if>
        <if test="priceChannelName!=null and priceChannelName!=''">
            and bnpbmr.price_channel_name=#{priceChannelName}
        </if>
        <if test="supplierCode!=null and supplierCode!=''">
            and bnpbmr.supplier_code=#{supplierCode}
        </if>
        <if test="supplierName!=null and supplierName!=''">
            and bnpbmr.supplier_name like concat('%', #{supplierName}, '%')
        </if>
        <if test="productCategoryCode!=null and productCategoryCode!=''">
            and bnpbmr.product_category_code=#{productCategoryCode}
        </if>
        <if test="beginCreateTime!=null and beginCreateTime!=''">
            and bnpbmr.create_time between #{beginCreateTime}
        </if>
        <if test="finishCreateTime!=null and finishCreateTime!=''">
            and #{finishCreateTime}
        </if>
        <if test="batchCode!=null and batchCode!=''">
            and bnpbmr.batch_code=#{batchCode}
        </if>
        <if test="beginMaoriRate!=null">
            and bnpbmr.maori_rate <![CDATA[>=]]> #{beginMaoriRate}
        </if>
        <if test="finishMaoriRate!=null">
            and bnpbmr.maori_rate <![CDATA[<=]]> #{finishMaoriRate}
        </if>
        <if test="productSortCode!=null and productSortCode!=''">
            and bnpbmr.product_sort_code=#{productSortCode}
        </if>
        <if test="productSortName!=null and productSortName!=''">
            and bnpbmr.product_sort_name like concat('%', #{productSortName}, '%')
        </if>
    </select>

</mapper>
