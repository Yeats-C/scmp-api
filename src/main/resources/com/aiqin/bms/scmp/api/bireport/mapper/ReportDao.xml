<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiqin.bms.scmp.api.bireport.dao.ReportDao">

    <resultMap id="supplierArrivalRateResultMap" type="com.aiqin.bms.scmp.api.bireport.domain.response.SupplierArrivalRateRespVo">
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="begin_run_time" jdbcType="VARCHAR" property="beginRunTime"/>
        <result column="finish_run_time" jdbcType="VARCHAR" property="finishRunTime"/>
        <result column="supplier_code" jdbcType="VARCHAR" property="supplierCode"/>
        <result column="supplier_name" jdbcType="VARCHAR" property="supplierName"/>
        <result column="category_code" jdbcType="VARCHAR" property="categoryCode"/>
        <result column="category_name" jdbcType="VARCHAR" property="categoryName"/>
        <result column="transport_center_code" jdbcType="VARCHAR" property="transportCenterCode"/>
        <result column="pre_inbound_num" jdbcType="VARCHAR" property="preInboundNum"/>
        <result column="pre_tax_amount" jdbcType="VARCHAR" property="preTaxAmount"/>
        <result column="pra_inbound_num" jdbcType="VARCHAR" property="praInboundNum"/>
        <result column="pra_tax_amount" jdbcType="VARCHAR" property="praTaxAmount"/>
        <result column="pra_tax_amount_rate" jdbcType="VARCHAR" property="praTaxAmountRate"/>
        <result column="responsible_person_name" jdbcType="VARCHAR" property="responsiblePersonName"/>
    </resultMap>

    <sql id="select_supplier_arrival_rate">
        <where>
            1=1
            <if test="supplierCode!=null and supplierCode!=''">
                and bsar.supplier_code like concat('%', #{supplierCode,jdbcType=VARCHAR}, '%')
            </if>
            <if test="supplierName!=null and supplierName!=''">
                and bsar.supplier_name like concat('%', #{supplierName,jdbcType=VARCHAR}}, '%')
            </if>
            <if test="transportCenterCode!=null and transportCenterCode!=''">
                and bsar.logistics_center_code like concat('%', #{transportCenterCode,jdbcType=VARCHAR}}, '%')
            </if>
            <if test="categoryCode!=null and categoryCode!=''">
                and bsar.category_code like concat('%', #{categoryCode,jdbcType=VARCHAR}}, '%')
            </if>
            <if test="categoryName!=null and categoryName!=''">
                and bsar.category_name like concat('%', #{categoryName,jdbcType=VARCHAR}}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bsar.run_time between #{beginRunTime,jdbcType=VARCHAR}}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime,jdbcType=VARCHAR}}
            </if>
        </where>
    </sql>
    <sql id="select_goods_buy_sales">
        <where>
            1=1
            <if test="supplierCode!=null and supplierCode!=''">
                and bgbs.supplier_code=#{supplierCode}
            </if>
            <if test="supplierName!=null and supplierName!=''">
                and bgbs.supplier_name like concat('%', #{supplierName}, '%')
            </if>
            <if test="skuCode!=null and skuCode!=''">
                and bgbs.sku_code=#{skuCode}
            </if>
            <if test="skuName!=null and skuName!=''">
                and bgbs.sku_name like concat('%', #{skuName}, '%')
            </if>
            <if test="transportCenterCode!=null and transportCenterCode!=''">
                and bgbs.transport_center_code=#{transportCenterCode}
            </if>
            <if test="transportCenterName!=null and transportCenterName!=''">
                and bgbs.transport_center_name like concat('%', #{transportCenterName}, '%')
            </if>
            <if test="productCategoryName!=null and productCategoryName!=''">
                and bgbs.category_name like concat('%', #{productCategoryName}, '%')
            </if>
            <if test="productCategoryCode!=null and productCategoryCode!=''">
                and bgbs.product_category_code=#{productCategoryCode}
            </if>
            <if test="productSortCode!=null and productSortCode!=''">
                and bgbs.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bgbs.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bgbs.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
            <if test="inboundDays!=null and inboundDays!=''">
                and bgbs.inbound_days=#{inboundDays}
            </if>
            <if test="beginTurnoverDays!=null">
                and bgbs.turnover_days <![CDATA[>=]]> #{beginTurnoverDays}
            </if>
            <if test="finishTurnoverDays!=null">
                and bgbs.turnover_days <![CDATA[<=]]> #{finishTurnoverDays}
            </if>
            <if test="warehouseCode!=null and warehouseCode!=''">
                and bgbs.warehouse_code=#{warehouseCode}
            </if>
            <if test="warehouseName!=null and warehouseName!=''">
                and bgbs.warehouse_name like concat('%', #{warehouseName}, '%')
            </if>
            <if test="productCategoryOne!=null and productCategoryOne!=''">
                and bgbs.product_category_one like concat('%', #{productCategoryOne}, '%')
            </if>
            <if test="productCategoryTwo!=null and productCategoryTwo!=''">
                and bgbs.product_category_two like concat('%', #{productCategoryTwo}, '%')
            </if>
            <if test="productCategoryThree!=null and productCategoryThree!=''">
                and bgbs.product_category_three like concat('%', #{productCategoryThree}, '%')
            </if>
            <if test="productCategoryFour!=null and productCategoryFour!=''">
                and bgbs.product_category_four like concat('%', #{productCategoryFour}, '%')
            </if>
        </where>
    </sql>
    <sql id="select_gifts_buy_sales">
        <where>
            1=1
            <if test="skuCode!=null and skuCode!=''">
                and bgbs.sku_code=#{skuCode}
            </if>
            <if test="skuName!=null and skuName!=''">
                and bgbs.sku_name like concat('%', #{skuName}, '%')
            </if>
            <if test="transportCenterCode!=null and transportCenterCode!=''">
                and bgbs.transport_center_code=#{transportCenterCode}
            </if>
            <if test="transportCenterName!=null and transportCenterName!=''">
                and bgbs.transport_center_name like concat('%', #{transportCenterName}, '%')
            </if>
            <if test="productCategoryName!=null and productCategoryName!=''">
                and bgbs.product_category_name like concat('%', #{productCategoryName}, '%')
            </if>
            <if test="productCategoryCode!=null and productCategoryCode!=''">
                and bgbs.product_category_code=#{productCategoryCode}
            </if>
            <if test="inboundDays!=null and inboundDays!=''">
                and bgbs.inbound_days=#{inboundDays}
            </if>
            <if test="productSortCode!=null and productSortCode!=''">
                and bgbs.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bgbs.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bgbs.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
            <if test="warehouseCode!=null and warehouseCode!=''">
                and bgbs.warehouse_code=#{warehouseCode}
            </if>
            <if test="warehouseName!=null and warehouseName!=''">
                and bgbs.warehouse_name like concat('%', #{warehouseName}, '%')
            </if>
            <if test="beginTurnoverDays!=null">
                and bgbs.turnover_days <![CDATA[>=]]> #{beginTurnoverDays}
            </if>
            <if test="finishTurnoverDays!=null">
                and bgbs.turnover_days <![CDATA[<=]]> #{finishTurnoverDays}
            </if>
            <if test="productCategoryOne!=null and productCategoryOne!=''">
                and bgbs.product_category_one like concat('%', #{productCategoryOne}, '%')
            </if>
            <if test="productCategoryTwo!=null and productCategoryTwo!=''">
                and bgbs.product_category_two like concat('%', #{productCategoryTwo}, '%')
            </if>
            <if test="productCategoryThree!=null and productCategoryThree!=''">
                and bgbs.product_category_three like concat('%', #{productCategoryThree}, '%')
            </if>
            <if test="productCategoryFour!=null and productCategoryFour!=''">
                and bgbs.product_category_four like concat('%', #{productCategoryFour}, '%')
            </if>
        </where>
    </sql>
    <sql id="select_supplier_return">
        <where>
            1=1
            <if test="supplierCode!=null and supplierCode!=''">
                and bsr.supplier_code=#{supplierCode}
            </if>
            <if test="supplierName!=null and supplierName!=''">
                and bsr.supplier_name like concat('%', #{supplierName}, '%')
            </if>
            <if test="transportCenterCode!=null and transportCenterCode!=''">
                and bsr.transport_center_code=#{transportCenterCode}
            </if>
            <if test="transportCenterName!=null and transportCenterName!=''">
                and bsr.transport_center_name like concat('%', #{transportCenterName}, '%')
            </if>
            <if test="warehouseCode!=null and warehouseCode!=''">
                and bsr.warehouse_code=#{warehouseCode}
            </if>
            <if test="warehouseName!=null and warehouseName!=''">
                and bsr.warehouse_name like concat('%', #{warehouseName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bsr.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
        </where>
    </sql>
    <sql id="select_new_product_batch_moving_rate">
        <where>
            1=1
            <if test="skuCode!=null and skuCode!=''">
                and bnpbmr.sku_code=#{skuCode}
            </if>
            <if test="skuName!=null and skuName!=''">
                and bnpbmr.sku_name like concat('%', #{skuName}, '%')
            </if>
            <if test="priceChannelCode!=null and priceChannelCode!=''">
                and bnpbmr.price_channel_code=#{priceChannelCode}
            </if>
            <if test="priceChannelName!=null and priceChannelName!=''">
                and bnpbmr.price_channel_name like concat('%', #{priceChannelName}, '%')
            </if>
            <if test="supplierCode!=null and supplierCode!=''">
                and bnpbmr.supplier_code=#{supplierCode}
            </if>
            <if test="supplierName!=null and supplierName!=''">
                and bnpbmr.supplier_name like concat('%', #{supplierName}, '%')
            </if>
            <if test="productCategoryCode!=null and productCategoryCode!=''">
                and bnpbmr.product_category_code=#{productCategoryCode}
            </if>
            <if test="productCategoryName!=null and productCategoryName!=''">
                and bnpbmr.product_category_name like concat('%', #{productCategoryName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bnpbmr.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
            <if test="batchCode!=null and batchCode!=''">
                and bnpbmr.batch_code=#{batchCode}
            </if>
            <if test="beginMaoriRate!=null">
                and bnpbmr.maori_rate <![CDATA[>=]]> #{beginMaoriRate}
            </if>
            <if test="finishMaoriRate!=null">
                and bnpbmr.maori_rate <![CDATA[<=]]> #{finishMaoriRate}
            </if>
            <if test="productSortCode!=null and productSortCode!=''">
                and bnpbmr.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bnpbmr.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
        </where>
    </sql>
    <sql id="select_store_repurchase_rate">
        <where>
            1=1
            <if test="provinceName!=null and provinceName!=''">
                and bsrr.province_name like concat('%', #{provinceName}, '%')
            </if>
            <if test="cityName!=null and cityName!=''">
                and bsrr.city_name like concat('%', #{cityName}, '%')
            </if>
            <if test="districtName!=null and districtName!=''">
                and bsrr.district_name like concat('%', #{districtName}, '%')
            </if>
            <if test="productCategoryCode!=null and productCategoryCode!=''">
                and bsrr.product_category_code=#{productCategoryCode}
            </if>
            <if test="productCategoryName!=null and productCategoryName!=''">
                and bsrr.product_category_name like concat('%', #{productCategoryName}, '%')
            </if>
            <if test="orderOriginalCode!=null and orderOriginalCode!=''">
                and bsrr.order_original_code=#{orderOriginalCode}
            </if>
            <if test="orderOriginalName!=null and orderOriginalName!=''">
                and bsrr.order_original_name like concat('%', #{orderOriginalName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bsrr.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
        </where>
    </sql>
    <sql id="select_negative_margin">
        <where>
            1=1
            <if test="skuCode!=null and skuCode!=''">
                and bnm.sku_code=#{skuCode}
            </if>
            <if test="skuName!=null and skuName!=''">
                and bnm.sku_name like concat('%', #{skuName}, '%')
            </if>
            <if test="productCategoryCode!=null and productCategoryCode!=''">
                and bnm.product_category_code=#{productCategoryCode}
            </if>
            <if test="productCategoryName!=null and productCategoryName!=''">
                and bnm.product_category_name like concat('%', #{productCategoryName}, '%')
            </if>
            <if test="productBrandCode!=null and productBrandCode!=''">
                and bnm.product_brand_code=#{productBrandCode}
            </if>
            <if test="productBrandName!=null and productBrandName!=''">
                and bnm.product_brand_name like concat('%', #{productBrandName}, '%')
            </if>
            <if test="orderOriginalCode!=null and orderOriginalCode!=''">
                and bnm.order_original_code=#{orderOriginalCode}
            </if>
            <if test="orderOriginalName!=null and orderOriginalName!=''">
                and bnm.order_original_name like concat('%', #{orderOriginalName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bnm.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
            <if test="productSortCode!=null and productSortCode!=''">
                and bnm.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bnm.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
        </where>
    </sql>
    <sql id="select_suggest_replenishment">
        <where>
            1=1
            <if test="skuCode!=null and skuCode!=''">
                and bsr.sku_code=#{skuCode}
            </if>
            <if test="skuName!=null and skuName!=''">
                and bsr.sku_name like concat('%', #{skuName}, '%')
            </if>
            <if test="productCategoryCode!=null and productCategoryCode!=''">
                and bsr.product_category_code=#{productCategoryCode}
            </if>
            <if test="productCategoryName!=null and productCategoryName!=''">
                and bsr.product_category_name like concat('%', #{productCategoryName}, '%')
            </if>
            <if test="productBrandCode!=null and productBrandCode!=''">
                and bsr.product_brand_code=#{productBrandCode}
            </if>
            <if test="productBrandName!=null and productBrandName!=''">
                and bsr.product_brand_name like concat('%', #{productBrandName}, '%')
            </if>
            <if test="transportCenterCode!=null and transportCenterCode!=''">
                and bsr.transport_center_code=#{transportCenterCode}
            </if>
            <if test="transportCenterName!=null and transportCenterName!=''">
                and bsr.transport_center_name like concat('%', #{transportCenterName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bsr.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
        </where>
    </sql>
    <sql id="select_low_inventory">
        <where>
            1=1
            <if test="procurementSectionCode!=null and procurementSectionCode!=''">
                and bli.procurement_section_code=#{procurementSectionCode}
            </if>
            <if test="procurementSectionName!=null and procurementSectionName!=''">
                and bli.procurement_section_name like concat('%', #{procurementSectionName}, '%')
            </if>
            <if test="productSortCode!=null and productSortCode!=''">
                and bli.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bli.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bli.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
        </where>
    </sql>
    <sql id="select_high_inventory">
        <where>
            1=1
            <if test="procurementSectionCode!=null and procurementSectionCode!=''">
                and bhi.procurement_section_code=#{procurementSectionCode}
            </if>
            <if test="procurementSectionName!=null and procurementSectionName!=''">
                and bhi.procurement_section_name like concat('%', #{procurementSectionName}, '%')
            </if>
            <if test="productSortCode!=null and productSortCode!=''">
                and bhi.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bhi.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bhi.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
        </where>
    </sql>
    <sql id="select_big_effect">
        <where>
            1=1
            <if test="productionDate!=null and productionDate!=''">
                and bbe.production_date like concat('%', #{productionDate}, '%')
            </if>
            <if test="skuCode!=null and skuCode!=''">
                and bbe.sku_code=#{skuCode}
            </if>
            <if test="skuName!=null and skuName!=''">
                and bbe.sku_name like concat('%', #{skuName}, '%')
            </if>
            <if test="productBrandCode!=null and productBrandCode!=''">
                and bbe.product_brand_code=#{productBrandCode}
            </if>
            <if test="productBrandName!=null and productBrandName!=''">
                and bbe.product_brand_name like concat('%', #{productBrandName}, '%')
            </if>
            <if test="productCategoryCode!=null and productCategoryCode!=''">
                and bbe.product_category_code=#{productCategoryCode}
            </if>
            <if test="productCategoryName!=null and productCategoryName!=''">
                and bbe.product_category_name like concat('%', #{productCategoryName}, '%')
            </if>
            <if test="supplyUnitCode!=null and supplyUnitCode!=''">
                and bbe.supply_unit_code=#{supplyUnitCode}
            </if>
            <if test="supplyUnitName!=null and supplyUnitName!=''">
                and bbe.supply_unit_name like concat('%', #{supplyUnitName}, '%')
            </if>
            <if test="procurementSectionCode!=null and procurementSectionCode!=''">
                and bbe.procurement_section_code=#{procurementSectionCode}
            </if>
            <if test="procurementSectionName!=null and procurementSectionName!=''">
                and bbe.procurement_section_name like concat('%', #{procurementSectionName}, '%')
            </if>
            <if test="transportCenterCode!=null and transportCenterCode!=''">
                and bbe.transport_center_code=#{transportCenterCode}
            </if>
            <if test="transportCenterName!=null and transportCenterName!=''">
                and bbe.transport_center_name like concat('%', #{transportCenterName}, '%')
            </if>
            <if test="warehouseCode!=null and warehouseCode!=''">
                and bbe.warehouse_code=#{warehouseCode}
            </if>
            <if test="warehouseName!=null and warehouseName!=''">
                and bbe.warehouse_name like concat('%', #{warehouseName}, '%')
            </if>
            <if test="bigEffectPeriodWarnDay!=null and bigEffectPeriodWarnDay!=''">
                and bbe.big_effect_period_warn_day=#{bigEffectPeriodWarnDay}
            </if>
        </where>
    </sql>
    <sql id="select_monthly_sales">
        <where>
            1=1
            <if test="productSortCode!=null and productSortCode!=''">
                and bms.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bms.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
            <if test="priceChannelCode!=null and priceChannelCode!=''">
                and bms.price_channel_code=#{priceChannelCode}
            </if>
            <if test="priceChannelName!=null and priceChannelName!=''">
                and bms.price_channel_name like concat('%', #{priceChannelName}, '%')
            </if>
            <if test="storeTypeCode!=null and storeTypeCode!=''">
                and bms.store_type_code=#{storeTypeCode}
            </if>
            <if test="storeTypeName!=null and storeTypeName!=''">
                and bms.store_type_name like concat('%', #{storeTypeName}, '%')
            </if>
            <if test="dataStyleCode!=null and dataStyleCode!=''">
                and bms.data_style_code=#{dataStyleCode}
            </if>
            <if test="dataStyleName!=null and dataStyleName!=''">
                and bms.data_style_name like concat('%', #{dataStyleName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bhi.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
        </where>
    </sql>
    <sql id="select_monthly_gross_margin">
        <where>
            1=1
            <if test="productSortCode!=null and productSortCode!=''">
                and bmgm.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bmgm.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
            <if test="priceChannelCode!=null and priceChannelCode!=''">
                and bmgm.price_channel_code=#{priceChannelCode}
            </if>
            <if test="priceChannelName!=null and priceChannelName!=''">
                and bmgm.price_channel_name like concat('%', #{priceChannelName}, '%')
            </if>
            <if test="storeTypeCode!=null and storeTypeCode!=''">
                and bmgm.store_type_code=#{storeTypeCode}
            </if>
            <if test="storeTypeName!=null and storeTypeName!=''">
                and bmgm.store_type_name like concat('%', #{storeTypeName}, '%')
            </if>
            <if test="dataStyleCode!=null and dataStyleCode!=''">
                and bmgm.data_style_code=#{dataStyleCode}
            </if>
            <if test="dataStyleName!=null and dataStyleName!=''">
                and bmgm.data_style_name like concat('%', #{dataStyleName}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bmgm.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
        </where>
    </sql>
    <sql id="select_month_sales_achievement">
        <where>
            1=1
            <if test="productSortCode!=null and productSortCode!=''">
                and bmsa.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bmsa.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
            <if test="priceChannelCode!=null and priceChannelCode!=''">
                and bmsa.price_channel_code=#{priceChannelCode}
            </if>
            <if test="priceChannelName!=null and priceChannelName!=''">
                and bmsa.price_channel_name like concat('%', #{priceChannelName}, '%')
            </if>
            <if test="storeTypeCode!=null and storeTypeCode!=''">
                and bmsa.store_type_code=#{storeTypeCode}
            </if>
            <if test="storeTypeName!=null and storeTypeName!=''">
                and bmsa.store_type_name like concat('%', #{storeTypeName}, '%')
            </if>
            <if test="data_style_code!=null and data_style_code!=''">
                and bmsa.data_style_code=#{data_style_code}
            </if>
            <if test="dataStyleCode!=null and dataStyleCode!=''">
                and bmsa.data_style_name like concat('%', #{dataStyleCode}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bmsa.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
            <if test="categoryTypeCode!=null and categoryTypeCode!=''">
                and bmsa.category_type_code=#{categoryTypeCode}
            </if>
            <if test="categoryTypeName!=null and categoryTypeName!=''">
                and bmsa.category_type_name like concat('%', #{categoryTypeName}, '%')
            </if>
        </where>
    </sql>
    <sql id="select_month_cumulative_brand_sales">
        <where>
            1=1
            <if test="productSortCode!=null and productSortCode!=''">
                and bmcbs.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bmcbs.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
            <if test="priceChannelCode!=null and priceChannelCode!=''">
                and bmcbs.price_channel_code=#{priceChannelCode}
            </if>
            <if test="priceChannelName!=null and priceChannelName!=''">
                and bmcbs.price_channel_name like concat('%', #{priceChannelName}, '%')
            </if>
            <if test="storeTypeCode!=null and storeTypeCode!=''">
                and bmcbs.store_type_code=#{storeTypeCode}
            </if>
            <if test="storeTypeName!=null and storeTypeName!=''">
                and bmcbs.store_type_name like concat('%', #{storeTypeName}, '%')
            </if>
            <if test="data_style_code!=null and data_style_code!=''">
                and bmcbs.data_style_code=#{data_style_code}
            </if>
            <if test="dataStyleCode!=null and dataStyleCode!=''">
                and bmcbs.data_style_name like concat('%', #{dataStyleCode}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bmcbs.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
            <if test="categoryTypeCode!=null and categoryTypeCode!=''">
                and bmcbs.category_type_code=#{categoryTypeCode}
            </if>
            <if test="categoryTypeName!=null and categoryTypeName!=''">
                and bmcbs.category_type_name like concat('%', #{categoryTypeName}, '%')
            </if>
        </where>
    </sql>
    <sql id="select_month_cumulative_gross_profit_margin">
        <where>
            1=1
            <if test="productSortCode!=null and productSortCode!=''">
                and bmcgpm.product_sort_code=#{productSortCode}
            </if>
            <if test="productSortName!=null and productSortName!=''">
                and bmcgpm.product_sort_name like concat('%', #{productSortName}, '%')
            </if>
            <if test="priceChannelCode!=null and priceChannelCode!=''">
                and bmcgpm.price_channel_code=#{priceChannelCode}
            </if>
            <if test="priceChannelName!=null and priceChannelName!=''">
                and bmcgpm.price_channel_name like concat('%', #{priceChannelName}, '%')
            </if>
            <if test="storeTypeCode!=null and storeTypeCode!=''">
                and bmcgpm.store_type_code=#{storeTypeCode}
            </if>
            <if test="storeTypeName!=null and storeTypeName!=''">
                and bmcgpm.store_type_name like concat('%', #{storeTypeName}, '%')
            </if>
            <if test="data_style_code!=null and data_style_code!=''">
                and bmcgpm.data_style_code=#{data_style_code}
            </if>
            <if test="dataStyleCode!=null and dataStyleCode!=''">
                and bmcgpm.data_style_name like concat('%', #{dataStyleCode}, '%')
            </if>
            <if test="beginRunTime!=null and beginRunTime!=''">
                and bmcgpm.run_time between #{beginRunTime}
            </if>
            <if test="finishRunTime!=null and finishRunTime!=''">
                and #{finishRunTime}
            </if>
            <if test="categoryTypeCode!=null and categoryTypeCode!=''">
                and bmcgpm.category_type_code=#{categoryTypeCode}
            </if>
            <if test="categoryTypeName!=null and categoryTypeName!=''">
                and bmcgpm.category_type_name like concat('%', #{categoryTypeName}, '%')
            </if>
        </where>
    </sql>
    <select id="selectSupplierArrivalRate" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.SupplierArrivalRateReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.SupplierArrivalRateRespVo">
        select
        bsar.id as id,
        #{beginRunTime}  as beginRunTime,
        #{finishRunTime} as finishRunTime,
        bsar.supplier_code as supplierCode,
        bsar.supplier_name as supplierName,
        bsar.category_code as categoryCode,
        bsar.category_name as categoryName,
        bsar.logistics_center_code as transportCenterCode,
        bsar.pre_inbound_num as preInboundNum,
        bsar.pre_tax_amount as preTaxAmount,
        bsar.pra_inbound_num as praInboundNum,
        bsar.pra_tax_amount as praTaxAmount,
        bsar.pra_tax_amount_rate as praTaxAmountRate,
        bsar.responsible_person_name as responsiblePersonName
        from bi_supplier_arrival_rate bsar
        <include refid="select_supplier_arrival_rate"/>
        order by bsar.id asc
    </select>
    <select id="countSupplierArrivalRate" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.SupplierArrivalRateReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bsar.id
        from bi_supplier_arrival_rate bsar
        WHERE
        1=1
        <if test="supplierCode!=null and supplierCode!=''">
            and bsar.supplier_code like concat('%', #{supplierCode,jdbcType=VARCHAR}, '%')
        </if>
        <if test="supplierName!=null and supplierName!=''">
            and bsar.supplier_name like concat('%', #{supplierName,jdbcType=VARCHAR}}, '%')
        </if>
        <if test="transportCenterCode!=null and transportCenterCode!=''">
            and bsar.logistics_center_code like concat('%', #{transportCenterCode,jdbcType=VARCHAR}}, '%')
        </if>
        <if test="categoryCode!=null and categoryCode!=''">
            and bsar.category_code like concat('%', #{categoryCode,jdbcType=VARCHAR}}, '%')
        </if>
        <if test="categoryName!=null and categoryName!=''">
            and bsar.category_name like concat('%', #{categoryName,jdbcType=VARCHAR}}, '%')
        </if>
        <if test="beginRunTime!=null and beginRunTime!=''">
            and bsar.run_time between #{beginRunTime,jdbcType=VARCHAR}}
        </if>
        <if test="finishRunTime!=null and finishRunTime!=''">
            and #{finishRunTime,jdbcType=VARCHAR}}
        </if>
        group by bsar.id
        ) as tmp
    </select>
    <select id="selectGoodsBuySales" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.GoodsBuySalesReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.GoodsBuySalesRespVo">
        select
        bgbs.id as id,
        #{beginRunTime}  as beginRunTime,
        #{finishRunTime} as finishRunTime,
        bgbs.supplier_code as supplierCode,
        bgbs.supplier_name as supplierName,
        bgbs.sku_code as skuCode,
        bgbs.sku_name as skuName,
        bgbs.batch_code as batchCode,
        bgbs.product_sort_code as productSortCode,
        bgbs.product_sort_name as productSortName,
        bgbs.transport_center_code as transportCenterCode,
        bgbs.transport_center_name as transportCenterName,
        bgbs.warehouse_code as warehouseCode,
        bgbs.warehouse_name as warehouseName,
        bgbs.category_name as productCategoryName,
        bgbs.product_category_code as productCategoryCode,
        bgbs.product_category_one as productCategoryOne,
        bgbs.product_category_two as productCategoryTwo,
        bgbs.product_category_three as productCategoryThree,
        bgbs.product_category_four as productCategoryFour,
        bgbs.product_brand_code as productBrandCode,
        bgbs.product_brand_name as productBrandName,
        bgbs.manufacturer_guide_price as manufacturerGuidePrice,
        bgbs.inventory_num as inventoryNum,
        bgbs.tax_cost as taxCost,
        bgbs.sales_num_one_month as salesNumOneMonth,
        bgbs.sales_cost_one_month as salesCostOneMonth,
        bgbs.fen_sales_money_one_month as fenSalesMoneyOneMonth,
        bgbs.fen_sales_maori_one_month as fenSalesMaoriOneMonth,
        bgbs.fen_sales_maori_one_month_rate as fenSalesMaoriOneMonthRate,
        bgbs.qun_sales_money_one_month as qunSalesMoneyOneMonth,
        bgbs.qun_sales_maori_one_month as qunSalesMaoriOneMonth,
        bgbs.qun_sales_maori_one_month_rate as qunSalesMaoriOneMonthRate,
        bgbs.turnover_days as turnoverDays,
        bgbs.create_time as createTime,
        bgbs.inbound_days as inboundDays,
        bgbs.config_status as configStatus,
        bgbs.responsible_person_code as responsiblePersonCode,
        bgbs.responsible_person_name as responsiblePersonName,
        bgbs.production_date as productionDate,
        bgbs.quality_number as qualityNumber
        from bi_goods_buy_sales bgbs
        <include refid="select_goods_buy_sales"/>
        order by bgbs.id asc
    </select>
    <select id="countGoodsBuySales" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.GoodsBuySalesReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bgbs.id
        from bi_goods_buy_sales bgbs
        <include refid="select_goods_buy_sales"/>
        group by bgbs.id
        ) as tmp
    </select>
    <select id="selectGiftsBuySales" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.GiftsBuySalesReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.GiftsBuySalesRespVo">
        select
        bgbs.id as id,
        bgbs.sku_code as skuCode,
        bgbs.sku_name as skuName,
        bgbs.category_name as categoryName,
        bgbs.product_category_code as productCategoryCode,
        bgbs.product_category_one as productCategoryOne,
        bgbs.product_category_two as productCategoryTwo,
        bgbs.product_category_three as productCategoryThree,
        bgbs.product_category_four as productCategoryFour,
        bgbs.product_sort_code as productSortCode,
        bgbs.product_sort_name as productSortName,
        bgbs.product_brand_code as productBrandCode,
        bgbs.product_brand_name as productBrandName,
        bgbs.manufacturer_guide_price as manufacturerGuidePrice,
        bgbs.transport_center_code as transportCenterCode,
        bgbs.transport_center_name as transportCenterName,
        bgbs.warehouse_code as warehouseCode,
        bgbs.warehouse_name as warehouseName,
        bgbs.inventory_num as inventoryNum,
        bgbs.sales_num_one_month as salesNumOneMonth,
        bgbs.sales_money_one_month as salesMoneyOneMonth,
        bgbs.turnover_days as turnoverDays,
        bgbs.create_time as createTime,
        bgbs.inbound_days as inboundDays,
        bgbs.responsible_person_code as responsiblePersonCode,
        bgbs.responsible_person_name as responsiblePersonName
        from bi_gifts_buy_sales bgbs
        <include refid="select_gifts_buy_sales"/>
        order by bgbs.id asc
    </select>
    <select id="countGiftsBuySales" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.GiftsBuySalesReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bgbs.id
        from bi_gifts_buy_sales bgbs
        <include refid="select_gifts_buy_sales"/>
        group by bgbs.id
        ) as tmp
    </select>
    <select id="selectSupplierReturn" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.SupplierReturnReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.SupplierReturnRespVo">
        select
        bsr.id as id,
        bsr.supplier_code as supplierCode,
        bsr.supplier_name as supplierName,
        bsr.transport_center_code as transportCenterCode,
        bsr.transport_center_name as transportCenterName,
        bsr.warehouse_code as warehouseCode,
        bsr.warehouse_name as warehouseName,
        bsr.reject_record_code as rejectRecordCode,
        bsr.sum_count as sumCount,
        bsr.sum_amount as sumAmount,
        bsr.create_time as createTime,
        bsr.out_stock_time as outStockTime,
        bsr.reject_status as rejectStatus,
        bsr.purchase_group_code as purchaseGroupCode,
        bsr.purchase_group_name as purchaseGroupName,
        bsr.responsible_person_code as responsiblePersonCode,
        bsr.responsible_person_name as responsiblePersonName
        from bi_supplier_return bsr
        <include refid="select_supplier_return"/>
        order by bsr.id asc
    </select>
    <select id="countSupplierReturn" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.SupplierReturnReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bsr.id
        from bi_supplier_return bsr
        <include refid="select_supplier_return"/>
        group by bsr.id
        ) as tmp
    </select>
    <select id="selectNewProductBatchMovingRate" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.NewProductBatchMovingRateReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.NewProductBatchMovingRateRespVo">
        select
        bnpbmr.id as id,
        bnpbmr.sku_code as skuCode,
        bnpbmr.sku_name as skuName,
        bnpbmr.batch_code as batchCode,
        bnpbmr.supplier_code as supplierCode,
        bnpbmr.supplier_name as supplierName,
        bnpbmr.product_sort_code as productSortCode,
        bnpbmr.product_sort_name as productSortName,
        bnpbmr.product_category_code as productCategoryCode,
        bnpbmr.product_category_name as productCategoryName,
        bnpbmr.product_category_one as productCategoryOne,
        bnpbmr.product_category_two as productCategoryTwo,
        bnpbmr.product_category_three as productCategoryThree,
        bnpbmr.product_category_four as productCategoryFour,
        bnpbmr.product_brand_code as productBrandCode,
        bnpbmr.product_brand_name as productBrandName,
        bnpbmr.purchase_price as purchasePrice,
        bnpbmr.manufacturer_guide_price as manufacturerGuidePrice,
        bnpbmr.inventory_num as inventoryNum,
        bnpbmr.tax_cost as taxCost,
        bnpbmr.price_channel_name as priceChannelName,
        bnpbmr.num as num,
        bnpbmr.sales_costs as salesCosts,
        bnpbmr.qun_amount as qunAmount,
        bnpbmr.qun_maori as qunMaori,
        bnpbmr.qun_maori_rate as qunMaoriRate,
        bnpbmr.fen_amount as fenAmount,
        bnpbmr.fen_maori as fenMaori,
        bnpbmr.fen_maori_rate as fenMaoriRate,
        bnpbmr.sales_num_one_month as salesNumOneMonth,
        bnpbmr.sales_cost_one_month as salesCostOneMonth,
        bnpbmr.turnover_days as turnoverDays,
        bnpbmr.create_time as createTime,
        bnpbmr.inbound_days as inboundDays,
        bnpbmr.config_status as configStatus,
        bnpbmr.responsible_person_code as responsiblePersonCode,
        bnpbmr.responsible_person_name as responsiblePersonName
        from bi_new_product_batch_moving_rate bnpbmr
        <include refid="select_new_product_batch_moving_rate"/>
        order by bnpbmr.id asc
    </select>
    <select id="countNewProductBatchMovingRate" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.NewProductBatchMovingRateReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bnpbmr.id
        from bi_new_product_batch_moving_rate bnpbmr
        <include refid="select_new_product_batch_moving_rate"/>
        group by bnpbmr.id
        ) as tmp
    </select>
    <select id="selectStoreRepurchaseRate" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.StoreRepurchaseRateReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.StoreRepurchaseRateRespVo">
        select
        bnm.id as id,
        bnm.order_original_code as orderOriginalCode,
        bnm.order_original_name as orderOriginalName,
        bnm.province_name as provinceName,
        bnm.city_name as cityName,
        bnm.district_name as districtName,
        bnm.product_category_code as productCategoryCode,
        bnm.product_category_name as productCategoryName,
        bnm.product_num as productNum,
        bnm.fen_order_amount as fenOrderAmount,
        bnm.qun_order_amount as qunOrderAmount,
        bnm.shopping_frequency as shoppingFrequency,
        bnm.after_buy_rate as afterBuyRate
        from bi_store_repurchase_rate bsrr
        <include refid="select_store_repurchase_rate"/>
        order by bsrr.id asc
    </select>
    <select id="countStoreRepurchaseRate" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.StoreRepurchaseRateReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bsrr.id
        from bi_store_repurchase_rate bsrr
        <include refid="select_store_repurchase_rate"/>
        group by bsrr.id
        ) as tmp
    </select>
    <select id="selectNegativeMargin" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.NegativeMarginReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.NegativeMarginRespVo">
        select
        bnm.id as id,
        bnm.order_original_code as orderOriginalCode,
        bnm.order_original_name as orderOriginalName,
        bnm.sku_code as skuCode,
        bnm.sku_name as skuName,
        bnm.product_category_code as productCategoryCode,
        bnm.product_category_name as productCategoryName,
        bnm.product_brand_code as productBrandCode,
        bnm.product_brand_name as productBrandName,
        bnm.product_num as productNum,
        bnm.sales_cost as salesCost,
        bnm.qun_order_amount as qunOrderAmount,
        bnm.qun_maori as qunMaori,
        bnm.qun_maori_rate as qunMaoriRate,
        bnm.fen_order_amount as fenOrderAmount,
        bnm.fen_maori as fenMaori,
        bnm.fen_maori_rate as fenMaoriRate,
        bnm.product_sort_code as productSortCode,
        bnm.product_sort_name as productSortName
        from bi_negative_margin bnm
        <include refid="select_negative_margin"/>
        order by bnm.id asc
    </select>
    <select id="countNegativeMargin" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.NegativeMarginReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bnm.id
        from bi_negative_margin bnm
        <include refid="select_negative_margin"/>
        group by bnm.id
        ) as tmp
    </select>
    <select id="selectSuggestReplenishment" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.SuggestReplenishmentReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.SuggestReplenishmentRespVo">
        select
        bsr.id as id,
        bsr.product_category_code as productCategoryCode,
        bsr.product_category_name as productCategoryName,
        bsr.product_brand_code as productBrandCode,
        bsr.product_brand_name as productBrandName,
        bsr.sku_code as skuCode,
        bsr.sku_name as skuName,
        bsr.transport_center_code as transportCenterCode,
        bsr.transport_center_name as transportCenterName,
        bsr.average_amount as averageAmount,
        bsr.available_num as availableNum,
        bsr.available_money as availableMoney,
        bsr.turnover_days as turnoverDays,
        bsr.out_stock_continuous_days as outStockContinuousDays,
        bsr.last_month_out_stock_days as lastMonthOutStockDays,
        bsr.advice_orders as adviceOrders,
        bsr.config_status as configStatus
        from bi_suggest_replenishment bsr
        <include refid="select_suggest_replenishment"/>
        order by bsr.id asc
    </select>
    <select id="countSuggestReplenishment" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.SuggestReplenishmentReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bsr.id
        from bi_suggest_replenishment bsr
        <include refid="select_suggest_replenishment"/>
        group by bsr.id
        ) as tmp
    </select>
    <select id="selectLowInventory" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.HighLowInventoryReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.LowInventoryRespVo">
        select
        bli.id as id,
        bli.product_sort_code as productSortCode,
        bli.product_sort_name as productSortName,
        bli.procurement_section_code as procurementSectionCode,
        bli.procurement_section_name as procurementSectionName,
        bli.responsible_person_code as responsiblePersonCode,
        bli.responsible_person_name as responsiblePersonName,
        bli.warehouse_type_code as warehouseTypeCode,
        bli.warehouse_type_name as warehouseTypeName,
        bli.lastweek_total_national as lastweekTotalNational,
        bli.thisweek_total_national as thisweekTotalNational,
        bli.total_sku_num as totalSkuNum,
        bli.low_inventory_num as lowInventoryNum,
        bli.low_inventory_ratio as low_Inventory_ratio
        from bi_low_inventory bli
        <include refid="select_low_inventory"/>
        order by bli.id asc
    </select>
    <select id="countLowInventory" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.HighLowInventoryReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bli.id
        from bi_low_inventory bli
        <include refid="select_low_inventory"/>
        group by bli.id
        ) as tmp
    </select>
    <select id="selectHighInventory" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.HighLowInventoryReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.HighInventoryRespVo">
        select
        bhi.id as id,
        bhi.product_sort_code as productSortCode,
        bhi.product_sort_name as productSortName,
        bhi.procurement_section_code as procurementSectionCode,
        bhi.procurement_section_name as procurementSectionName,
        bhi.responsible_person_code as responsiblePersonCode,
        bhi.responsible_person_name as responsiblePersonName,
        bhi.warehouse_type_code as warehouseTypeCode,
        bhi.warehouse_type_name as warehouseTypeName,
        bhi.lastweek_total_national as lastweekTotalNational,
        bhi.thisweek_total_national as thisweekTotalNational,
        bhi.high_inventory_amount as highInventoryAmount,
        bhi.inventory_total_amount as inventoryTotalAmount,
        bhi.high_inventory_ratio as highInventoryRatio
        from bi_high_inventory bhi
        <include refid="select_high_inventory"/>
        order by bhi.id asc
    </select>
    <select id="countHighInventory" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.HighLowInventoryReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bhi.id
        from bi_high_inventory bhi
        <include refid="select_high_inventory"/>
        group by bhi.id
        ) as tmp
    </select>
    <select id="selectBigEffect" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.BigEffectReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.BigEffectRespVo">
        select
        bbe.id as id,
        bbe.product_category_code as productCategoryCode,
        bbe.product_category_name as productCategoryName,
        bbe.product_brand_code as productBrandCode,
        bbe.product_brand_name as productBrandName,
        bbe.procurement_section_code as procurementSectionCode,
        bbe.procurement_section_name as procurementSectionName,
        bbe.supply_unit_code as supplyUnitCode,
        bbe.supply_unit_name as supplyUnitName,
        bbe.sku_code as skuCode,
        bbe.sku_name as skuName,
        bbe.production_date as productionDate,
        bbe.end_date as endDate,
        bbe.quality_number as qualityNumber,
        bbe.big_effect_period_warn_day as bigEffectPeriodWarnDay,
        bbe.transport_center_code as transportCenterCode,
        bbe.transport_center_name as transportCenterName
        from bi_big_effect bbe
        <include refid="select_big_effect"/>
        order by bbe.id asc
    </select>
    <select id="countBigEffect" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.BigEffectReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bbe.id
        from bi_big_effect bbe
        <include refid="select_big_effect"/>
        group by bbe.id
        ) as tmp
    </select>
    <select id="selectMonthlySales" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.MonthlySalesReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.MonthlySalesRespVo">
        select
        bms.id as id,
        #{beginRunTime}  as beginRunTime,
        #{finishRunTime} as finishRunTime,
        bms.product_sort_code as productSortCode,
        bms.product_sort_name as productSortName,
        bms.price_channel_code as priceChannelCode,
        bms.price_channel_name as priceChannelName,
        bms.store_type_code as storeTypeCode,
        bms.store_type_name as storeTypeName,
        bms.data_style_code as dataStyleCode,
        bms.data_style_name as dataStyleName,
        bms.qun_order_amount as qunOrderAmount,
        bms.qun_last_year_sales as qunLastYearSales,
        bms.qun_last_month_sales as qunLastMonthSales,
        bms.qun_compared_same as qunComparedSame,
        bms.qun_sequential as qunSequential,
        bms.fen_order_amount as fenOrderAmount,
        bms.fen_last_year_sales as fenLastYearSales,
        bms.fen_last_month_sales as fenLastMonthSales,
        bms.fen_compared_same as fenComparedSame,
        bms.fen_sequential as fenSequential
        from bi_monthly_sales bms
        <include refid="select_monthly_sales"/>
        order by bms.id asc
    </select>
    <select id="countMonthlySales" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.MonthlySalesReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bms.id
        from bi_monthly_sales bms
        <include refid="select_monthly_sales"/>
        group by bms.id
        ) as tmp
    </select>
    <select id="selectMonthlyGrossMargin" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.MonthlySalesReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.MonthlySalesRespVo">
        select
        bmgm.id as id,
        #{beginRunTime}  as beginRunTime,
        #{finishRunTime} as finishRunTime,
        bmgm.product_sort_code as productSortCode,
        bmgm.product_sort_name as productSortName,
        bmgm.price_channel_code as priceChannelCode,
        bmgm.price_channel_name as priceChannelName,
        bmgm.store_type_code as storeTypeCode,
        bmgm.store_type_name as storeTypeName,
        bmgm.data_style_code as dataStyleCode,
        bmgm.data_style_name as dataStyleName,
        bmgm.qun_order_amount as qunOrderAmount,
        bmgm.qun_last_year_sales as qunLastYearSales,
        bmgm.qun_last_month_sales as qunLastMonthSales,
        bmgm.qun_compared_same as qunComparedSame,
        bmgm.qun_sequential as qunSequential,
        bmgm.fen_order_amount as fenOrderAmount,
        bmgm.fen_last_year_sales as fenLastYearSales,
        bmgm.fen_last_month_sales as fenLastMonthSales,
        bmgm.fen_compared_same as fenComparedSame,
        bmgm.fen_sequential as fenSequential
        from bi_month_gross_margin bmgm
        <include refid="select_monthly_gross_margin"/>
        order by bmgm.id asc
    </select>
    <select id="countMonthlyGrossMargin" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.MonthlySalesReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bmgm.id
        from bi_month_gross_margin bmgm
        <include refid="select_monthly_gross_margin"/>
        group by bmgm.id
        ) as tmp
    </select>
    <select id="selectMonthSalesAchievement" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.MonthSalesAchievementReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.MonthSalesAchievementRespVo">
        select
        bmsa.id as id,
        #{beginRunTime}  as beginRunTime,
        #{finishRunTime} as finishRunTime,
        bmsa.product_sort_code as productSortCode,
        bmsa.product_sort_name as productSortName,
        bmsa.price_channel_code as priceChannelCode,
        bmsa.price_channel_name as priceChannelName,
        bmsa.store_type_code as storeTypeCode,
        bmsa.store_type_name as storeTypeName,
        bmsa.data_style_code as dataStyleCode,
        bmsa.data_style_name as dataStyleName,
        bmsa.category_type_code as categoryTypeCode,
        bmsa.category_type_name as categoryTypeName,
        bmsa.qun_amount as qunAmount,
        bmsa.qun_budget as qunBudget,
        bmsa.qun_yield_rate as qunYieldRate,
        bmsa.fen_amount as fenAmount,
        bmsa.fen_budget as febBudget,
        bmsa.fen_yield_rate as fenYieldRate
        from bi_month_sales_achievement bmsa
        <include refid="select_month_sales_achievement"/>
        order by bmsa.id asc
    </select>
    <select id="countMonthSalesAchievement" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.MonthSalesAchievementReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bmsa.id
        from bi_month_sales_achievement bmsa
        <include refid="select_month_sales_achievement"/>
        group by bmsa.id
        ) as tmp
    </select>
    <select id="selectMonthCumulativeBrandSales" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.MonthSalesAchievementReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.MonthCumulativeBrandSalesRespVo">
        select
        bmcbs.id as id,
        #{beginRunTime}  as beginRunTime,
        #{finishRunTime} as finishRunTime,
        bmcbs.product_sort_code as productSortCode,
        bmcbs.product_sort_name as productSortName,
        bmcbs.price_channel_code as priceChannelCode,
        bmcbs.price_channel_name as priceChannelName,
        bmcbs.store_type_code as storeTypeCode,
        bmcbs.store_type_name as storeTypeName,
        bmcbs.data_style_code as dataStyleCode,
        bmcbs.data_style_name as dataStyleName,
        bmcbs.category_type_code as categoryTypeCode,
        bmcbs.category_type_name as categoryTypeName,
        bmcbs.qun_order_amount as qunOrderAmount,
        bmcbs.qun_last_year_sales as qunLastYearSales,
        bmcbs.qun_last_month_sales as qunLastMonthSales,
        bmcbs.qun_compared_same as qunComparedSame,
        bmcbs.qun_sequential as qunSequential,
        bmcbs.fen_order_amount as fenOrderAmount,
        bmcbs.fen_last_year_sales as fenLastYearSales,
        bmcbs.fen_last_month_sales as fenLastMonthSales,
        bmcbs.fen_compared_same as fenComparedSame,
        bmcbs.fen_sequential as fenSequential
        from bi_month_cumulative_brand_sales bmcbs
        <include refid="select_month_cumulative_brand_sales"/>
        order by bmcbs.id asc
    </select>
    <select id="countMonthCumulativeBrandSales" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.MonthSalesAchievementReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bmcbs.id
        from bi_month_cumulative_brand_sales bmcbs
        <include refid="select_month_cumulative_brand_sales"/>
        group by bmcbs.id
        ) as tmp
    </select>
    <select id="selectMonthCumulativeGrossProfitMargin" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.MonthSalesAchievementReqVo"
            resultType="com.aiqin.bms.scmp.api.bireport.domain.response.MonthCumulativeGrossProfitMarginRespVo">
        select
        bmcgpm.id as id,
        #{beginRunTime}  as beginRunTime,
        #{finishRunTime} as finishRunTime,
        bmcgpm.product_sort_code as productSortCode,
        bmcgpm.product_sort_name as productSortName,
        bmcgpm.price_channel_code as priceChannelCode,
        bmcgpm.price_channel_name as priceChannelName,
        bmcgpm.store_type_code as storeTypeCode,
        bmcgpm.store_type_name as storeTypeName,
        bmcgpm.data_style_code as dataStyleCode,
        bmcgpm.data_style_name as dataStyleName,
        bmcgpm.category_type_code as categoryTypeCode,
        bmcgpm.category_type_name as categoryTypeName,
        bmcgpm.sales_cost as salesCost,
        bmcgpm.qun_amount as qunAmount,
        bmcgpm.qun_maori as qunMaori,
        bmcgpm.qun_maori_rate as qunMaoriRate,
        bmcgpm.qun_last_maori_rate as qunLastMaoriRate,
        bmcgpm.qun_compared_same as qunComparedSame,
        bmcgpm.qun_sequential as qunSequential,
        bmcgpm.fen_amount as fenAmount,
        bmcgpm.fen_maori as fenMaori,
        bmcgpm.fen_maori_rate as fenMaoriRate,
        bmcgpm.fen_last_maori_rate as fenLastMaoriRate,
        bmcgpm.fen_compared_same as fenComparedSame,
        bmcgpm.fen_sequential as fenSequential
        from bi_month_cumulative_gross_profit_margin bmcgpm
        <include refid="select_month_cumulative_gross_profit_margin"/>
        order by bmcgpm.id asc
    </select>
    <select id="countMonthCumulativeGrossProfitMargin" parameterType="com.aiqin.bms.scmp.api.bireport.domain.request.MonthSalesAchievementReqVo"
            resultType="java.lang.Integer">
        select count(1) from (
        select
        bmcgpm.id
        from bi_month_cumulative_gross_profit_margin bmcgpm
        <include refid="select_month_cumulative_gross_profit_margin"/>
        group by bmcgpm.id
        ) as tmp
    </select>
    <select id="selectStoreType" resultType="com.aiqin.bms.scmp.api.bireport.domain.response.MonthlySalesRespVo">
        SELECT
        bms.store_type_code as storeTypeCode,
        bms.store_type_name as storeTypeName
        FROM bi_monthly_sales bms
    </select>
    <select id="selectDataStyle" resultType="com.aiqin.bms.scmp.api.bireport.domain.response.MonthlySalesRespVo">
        SELECT
        bms.data_style_code as dataStyleCode,
        bms.data_style_name as dataStyleName
        FROM bi_monthly_sales bms
    </select>
</mapper>
