<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiqin.bms.scmp.api.product.mapper.ProductSkuPriceInfoMapper">
    <resultMap id="BaseResultMap" type="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceInfo">
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="code" jdbcType="VARCHAR" property="code"/>
        <result column="sku_code" jdbcType="VARCHAR" property="skuCode"/>
        <result column="sku_name" jdbcType="VARCHAR" property="skuName"/>
        <result column="purchase_group_code" jdbcType="VARCHAR" property="purchaseGroupCode"/>
        <result column="purchase_group_name" jdbcType="VARCHAR" property="purchaseGroupName"/>
        <result column="price_item_code" jdbcType="VARCHAR" property="priceItemCode"/>
        <result column="price_item_name" jdbcType="VARCHAR" property="priceItemName"/>
        <result column="price_type_code" jdbcType="VARCHAR" property="priceTypeCode"/>
        <result column="price_type_name" jdbcType="VARCHAR" property="priceTypeName"/>
        <result column="price_attribute_code" jdbcType="VARCHAR" property="priceAttributeCode"/>
        <result column="price_attribute_name" jdbcType="VARCHAR" property="priceAttributeName"/>
        <result column="price_tax" jdbcType="DECIMAL" property="priceTax"/>
        <result column="price_no_tax" jdbcType="DECIMAL" property="priceNoTax"/>
        <result column="tax" jdbcType="BIGINT" property="tax"/>
        <result column="effective_time_start" jdbcType="TIMESTAMP" property="effectiveTimeStart"/>
        <result column="effective_time_end" jdbcType="TIMESTAMP" property="effectiveTimeEnd"/>
        <result column="supplier_code" jdbcType="VARCHAR" property="supplierCode"/>
        <result column="supplier_name" jdbcType="VARCHAR" property="supplierName"/>
        <result column="be_default" jdbcType="INTEGER" property="beDefault"/>
        <result column="create_by" jdbcType="VARCHAR" property="createBy"/>
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime"/>
        <result column="update_by" jdbcType="VARCHAR" property="updateBy"/>
        <result column="update_time" jdbcType="TIMESTAMP" property="updateTime"/>
        <result column="warehouse_batch_number" jdbcType="VARCHAR" property="warehouseBatchNumber"/>
        <result column="warehouse_batch_name" jdbcType="VARCHAR" property="warehouseBatchName"/>
        <result column="transport_center_code" jdbcType="VARCHAR" property="transportCenterCode"/>
        <result column="transport_center_name" jdbcType="VARCHAR" property="transportCenterName"/>
        <result column="warehouse_code" jdbcType="VARCHAR" property="warehouseCode"/>
        <result column="warehouse_name" jdbcType="VARCHAR" property="warehouseName"/>
        <result column="batch_remark" jdbcType="VARCHAR" property="batchRemark"/>
        <result column="product_time" jdbcType="TIMESTAMP" property="productTime"/>
        <result column="apply_code" jdbcType="VARCHAR" property="applyCode"/>
        <result column="company_code" jdbcType="VARCHAR" property="companyCode"/>
        <result column="company_name" jdbcType="VARCHAR" property="companyName"/>
        <result column="be_synchronous" jdbcType="INTEGER" property="beSynchronous"/>
        <result column="be_contain_area" jdbcType="INTEGER" property="beContainArea"/>
    </resultMap>
    <resultMap id="selectByPriceStatusAndDate"
               type="com.aiqin.bms.scmp.api.product.domain.dto.changeprice.ProductSkuPriceInfoDTO">
        <id column="aid" jdbcType="BIGINT" property="id"/>
        <result column="acode" jdbcType="VARCHAR" property="code"/>
        <result column="asku_code" jdbcType="VARCHAR" property="skuCode"/>
        <result column="asku_name" jdbcType="VARCHAR" property="skuName"/>
        <result column="apurchase_group_code" jdbcType="VARCHAR" property="purchaseGroupCode"/>
        <result column="apurchase_group_name" jdbcType="VARCHAR" property="purchaseGroupName"/>
        <result column="aprice_item_code" jdbcType="VARCHAR" property="priceItemCode"/>
        <result column="aprice_item_name" jdbcType="VARCHAR" property="priceItemName"/>
        <result column="aprice_type_code" jdbcType="VARCHAR" property="priceTypeCode"/>
        <result column="aprice_type_name" jdbcType="VARCHAR" property="priceTypeName"/>
        <result column="aprice_attribute_code" jdbcType="VARCHAR" property="priceAttributeCode"/>
        <result column="aprice_attribute_name" jdbcType="VARCHAR" property="priceAttributeName"/>
        <result column="aprice_tax" jdbcType="BIGINT" property="priceTax"/>
        <result column="aprice_no_tax" jdbcType="BIGINT" property="priceNoTax"/>
        <result column="atax" jdbcType="BIGINT" property="tax"/>
        <result column="aeffective_time_start" jdbcType="TIMESTAMP" property="effectiveTimeStart"/>
        <result column="aeffective_time_end" jdbcType="TIMESTAMP" property="effectiveTimeEnd"/>
        <result column="asupplier_code" jdbcType="VARCHAR" property="supplierCode"/>
        <result column="asupplier_name" jdbcType="VARCHAR" property="supplierName"/>
        <result column="abe_default" jdbcType="INTEGER" property="beDefault"/>
        <result column="acreate_by" jdbcType="VARCHAR" property="createBy"/>
        <result column="acreate_time" jdbcType="TIMESTAMP" property="createTime"/>
        <result column="aupdate_by" jdbcType="VARCHAR" property="updateBy"/>
        <result column="aupdate_time" jdbcType="TIMESTAMP" property="updateTime"/>
        <result column="awarehouse_batch_number" jdbcType="VARCHAR" property="warehouseBatchNumber"/>
        <result column="awarehouse_batch_name" jdbcType="VARCHAR" property="warehouseBatchName"/>
        <result column="atransport_center_code" jdbcType="VARCHAR" property="transportCenterCode"/>
        <result column="atransport_center_name" jdbcType="VARCHAR" property="transportCenterName"/>
        <result column="awarehouse_code" jdbcType="VARCHAR" property="warehouseCode"/>
        <result column="awarehouse_name" jdbcType="VARCHAR" property="warehouseName"/>
        <result column="abatch_remark" jdbcType="VARCHAR" property="batchRemark"/>
        <result column="aproduct_time" jdbcType="TIMESTAMP" property="productTime"/>
        <result column="aapply_code" jdbcType="VARCHAR" property="applyCode"/>
        <result column="acompany_code" jdbcType="VARCHAR" property="companyCode"/>
        <result column="acompany_name" jdbcType="VARCHAR" property="companyName"/>
        <result column="abe_synchronous" jdbcType="INTEGER" property="beSynchronous"/>
        <result column="abe_contain_area" jdbcType="INTEGER" property="beContainArea"/>
        <collection property="areaInfos" ofType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceAreaInfo">
            <id column="bid" jdbcType="BIGINT" property="id"/>
            <result column="bmain_code" jdbcType="VARCHAR" property="mainCode"/>
            <result column="btype" jdbcType="INTEGER" property="type"/>
            <result column="bstatus" jdbcType="INTEGER" property="status"/>
            <result column="bname" jdbcType="VARCHAR" property="name"/>
            <result column="bcode" jdbcType="VARCHAR" property="code"/>
            <result column="bcompany_code" jdbcType="VARCHAR" property="companyCode"/>
            <result column="bcompany_name" jdbcType="VARCHAR" property="companyName"/>
            <result column="beffective_time_start" jdbcType="TIMESTAMP" property="effectiveTimeStart"/>
            <result column="beffective_time_end" jdbcType="TIMESTAMP" property="effectiveTimeEnd"/>
            <result column="bbe_effective" jdbcType="INTEGER" property="beEffective"/>
            <result column="bun_effective_reason" jdbcType="VARCHAR" property="unEffectiveReason"/>
        </collection>
    </resultMap>

    <sql id="Base_Column_List">
    id, code, sku_code, sku_name, purchase_group_code, purchase_group_name, price_item_code, 
    price_item_name, price_type_code, price_type_name, price_attribute_code, price_attribute_name, 
    price_tax, price_no_tax, tax, effective_time_start, effective_time_end, supplier_code, 
    supplier_name, be_default, create_by, create_time, update_by, update_time, warehouse_batch_number, 
    warehouse_batch_name, transport_center_code, transport_center_name, warehouse_code, 
    warehouse_name, batch_remark, product_time, apply_code, company_code, company_name, 
    be_synchronous, be_contain_area
  </sql>

    <sql id="select_by_price_status_and_date">
  a.id aid, a.code acode, a.sku_code asku_code, a.sku_name asku_name, a.purchase_group_code apurchase_group_code, a.purchase_group_name apurchase_group_name, a.price_item_code aprice_item_code, a.price_item_name aprice_item_name, a.price_type_code aprice_type_code, a.price_type_name aprice_type_name, a.price_attribute_code aprice_attribute_code, a.price_attribute_name aprice_attribute_name, a.price_tax aprice_tax, a.price_no_tax aprice_no_tax, a.tax atax, a.effective_time_start aeffective_time_start, a.effective_time_end aeffective_time_end, a.supplier_code asupplier_code, a.supplier_name asupplier_name, a.be_default abe_default, a.create_by acreate_by, a.create_time acreate_time, a.update_by aupdate_by, a.update_time aupdate_time, a.warehouse_batch_number awarehouse_batch_number, a.warehouse_batch_name awarehouse_batch_name, a.transport_center_code atransport_center_code, a.transport_center_name atransport_center_name, a.warehouse_code awarehouse_code, a.warehouse_name awarehouse_name, a.batch_remark abatch_remark, a.product_time aproduct_time, a.apply_code aapply_code, a.company_code acompany_code, a.company_name acompany_name, a.be_synchronous abe_synchronous,a.be_contain_area abe_contain_area, b.id bid, b.main_code bmain_code, b.type btype, b.status bstatus, b.name bname, b.code bcode, b.company_code bcompany_code, b.company_name bcompany_name, b.effective_time_start beffective_time_start, b.effective_time_end beffective_time_end, b.be_effective bbe_effective, b.un_effective_reason bun_effective_reason
</sql>

    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from product_sku_price_info
        where id = #{id,jdbcType=BIGINT}
    </select>
    <select id="checkRepeat" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from product_sku_price_info
        where company_code = #{vo.companyCode}
        and be_contain_area = 0
        and price_attribute_code = #{vo.priceType}
        <if test="vo.skuCode != null and vo.skuCode.size>0">
            and sku_code in
            <foreach collection="vo.skuCode" separator="," open="(" close=")" item="item">
                #{item}
            </foreach>
        </if>
        <if test="vo.supplierCode != null and vo.supplierCode.size>0">
            and supplier_code in
            <foreach collection="vo.supplierCode" separator="," open="(" close=")" item="item">
                #{item}
            </foreach>
        </if>
        <if test="vo.warehouseBatchNumber != null and vo.warehouseBatchNumber.size>0">
            and warehouse_batch_number in
            <foreach collection="vo.warehouseBatchNumber" separator="," open="(" close=")" item="item">
                #{item}
            </foreach>
        </if>
        <if test="vo.transportCenterCode != null and vo.transportCenterCode.size>0">
            and transport_center_code in
            <foreach collection="vo.transportCenterCode" separator="," open="(" close=")" item="item">
                #{item}
            </foreach>
        </if>
        <if test="vo.warehouseCode != null and vo.warehouseCode.size>0">
            and warehouse_code in
            <foreach collection="vo.warehouseCode" separator="," open="(" close=")" item="item">
                #{item}
            </foreach>
        </if>
        <if test="vo.priceItemCode != null and vo.priceItemCode.size>0">
            and price_item_code in
            <foreach collection="vo.priceItemCode" separator="," open="(" close=")" item="item">
                #{item}
            </foreach>
        </if>
    </select>
    <select id="selectByPriceStatusAndDate"
            resultMap="selectByPriceStatusAndDate">
        select
        <include refid="select_by_price_status_and_date"/>
        from product_sku_price_info a
        left join product_sku_change_price_area_info b on a.code = b.main_code
        where a.be_synchronous = 0 and <![CDATA[ now() >= ]]>a.effective_time_start
    </select>
    <select id="selectUnEffectiveData"
            resultMap="selectByPriceStatusAndDate">
        select
        <include refid="select_by_price_status_and_date"/>
        from product_sku_price_info a
        left join product_sku_change_price_area_info b on a.code = b.main_code
        where <![CDATA[ now() >= ]]>a.effective_time_end
    </select>
    <select id="selectByCodes" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from product_sku_price_info
        where 1=1
        <if test="codes != null and codes.size>0">
            <foreach collection="codes" separator="," open="(" close=")" item="item">
                code = #{item}
            </foreach>
        </if>
    </select>
    <resultMap id="SelectListByQueryVO"
               type="com.aiqin.bms.scmp.api.product.domain.response.price.QueryProductSkuPriceInfoRespVO">
        <result column="acode" property="code"/>
        <result column="asku_code" property="skuCode"/>
        <result column="asku_name" property="skuName"/>
        <result column="aprice_item_name" property="priceItemName"/>
        <result column="aprice_type_name" property="priceTypeName"/>
        <result column="aprice_tax" property="priceTax"/>
        <result column="aeffective_time_start" property="effectiveTimeStart"/>
        <result column="aeffective_time_end" property="effectiveTimeEnd"/>
        <result column="asupplier_name" property="supplierName"/>
        <result column="abe_default" property="beDefault"/>
        <result column="awarehouse_batch_number" property="warehouseBatchNumber"/>
        <result column="awarehouse_batch_name" property="warehouseBatchName"/>
        <result column="atransport_center_name" property="transportCenterName"/>
        <result column="awarehouse_name" property="warehouseName"/>
        <result column="abatch_remark" property="batchRemark"/>
        <result column="aproduct_time" property="productTime"/>
        <result column="bproduct_category_name" property="productCategoryName"/>
        <result column="bproduct_category_code" property="productCategoryCode"/>
        <result column="bproduct_brand_name" property="productBrandName"/>
        <result column="bproduct_property_name" property="productPropertyName"/>
        <collection property="areaInfos" ofType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceAreaInfo">
            <result column="ctype" jdbcType="INTEGER" property="type"/>
            <result column="cstatus" jdbcType="INTEGER" property="status"/>
            <result column="cname" jdbcType="VARCHAR" property="name"/>
            <result column="ccode" jdbcType="VARCHAR" property="code"/>
        </collection>
    </resultMap>
    <select id="selectListByQueryVO" parameterType="java.util.List" resultMap="SelectListByQueryVO">
        select
        a.code acode, a.sku_code asku_code, a.sku_name asku_name, a.price_item_name aprice_item_name,
        a.price_type_name aprice_type_name, a.price_tax aprice_tax, a.supplier_name asupplier_name,
        a.warehouse_batch_number awarehouse_batch_number, a.transport_center_name atransport_center_name,
        a.warehouse_name awarehouse_name, a.batch_remark abatch_remark, a.effective_time_end aeffective_time_end,
        a.effective_time_start aeffective_time_start, a.be_default abe_default, a.product_time aproduct_time,
        b.product_category_code bproduct_category_code, b.product_category_name bproduct_category_name,
        b.product_brand_name bproduct_brand_name, b.product_property_name bproduct_property_name,
        c.name cname, c.type ctype, c.status cstatus, c.code ccode
        from product_sku_price_info a
        left join product_sku b on a.sku_code = b.sku_code
        left join product_sku_price_area_info c on a.code = c.main_code
        where a.company_code = #{companyCode}
        <if test="priceTypeCode != null and priceTypeCode !=''">
            and a.price_type_code = #{priceTypeCode}
        </if>
        <if test="priceItemCode != null and priceItemCode !=''">
            and a.price_item_code = #{priceItemCode}
        </if>
        <if test="priceFrom != null and priceFrom !=''">
            and a.price_tax &gt;= #{priceFrom}
        </if>
        <if test="priceTo != null and priceTo !=''">
            and a.price_tax &lt;= #{priceTo}
        </if>
        <if test="effectiveTimeStartFrom != null">
            and a.effective_time_start&gt;=#{effectiveTimeStartFrom,jdbcType=TIMESTAMP}
        </if>
        <if test="effectiveTimeStartTo != null">
            and a.effective_time_start&lt;=#{effectiveTimeStartTo,jdbcType=TIMESTAMP}
        </if>
        <if test="effectiveTimeEndFrom != null">
            and a.effective_time_end&gt;=#{effectiveTimeEndFrom,jdbcType=TIMESTAMP}
        </if>
        <if test="effectiveTimeEndTo != null">
            and a.effective_time_end&lt;=#{effectiveTimeEndTo,jdbcType=TIMESTAMP}
        </if>
        <if test="productStatus != null and productStatus !=''">
            and b.sku_status = #{productStatus}
        </if>
        <if test="skuCode != null and skuCode !=''">
            and a.sku_code = #{skuCode}
        </if>
        <if test="skuName != null and skuName !=''">
            and a.sku_name LIKE CONCAT('',#{skuName},'%')
        </if>
        <if test="supplierCode != null and supplierCode !=''">
            and a.supplier_code = #{supplierCode}
        </if>
        <if test="purchaseGroupCode != null and purchaseGroupCode !=''">
            and a.purchase_group_code = #{purchaseGroupCode}
        </if>
        <if test="productCategoryCode != null and productCategoryCode !=''">
            and b.product_category_code = #{productCategoryCode}
        </if>
        <if test="productBrandCode != null and productBrandCode !=''">
            and b.product_brand_code = #{productBrandCode}
        </if>
        <if test="productPropertyCode != null and productPropertyCode !=''">
            and b.product_property_code = #{productPropertyCode}
        </if>
        <if test="priceAttributeCode != null and priceAttributeCode !=''">
            and a.price_attribute_code = #{priceAttributeCode}
        </if>
        <if test="batchNumber != null and batchNumber !=''">
            and a.warehouse_batch_number = #{batchNumber}
        </if>
        order by a.create_time desc
        LIMIT #{beginIndex,jdbcType=INTEGER}, #{pageSize,jdbcType=INTEGER}
    </select>
    <select id="selectListByQueryVOCount" resultType="java.lang.Integer">
        select count(1)
        from product_sku_price_info a
        left join product_sku b
        on a.sku_code = b.sku_code
        where a.company_code = #{companyCode}
        <if test="priceTypeCode != null and priceTypeCode !=''">
            and a.price_type_code = #{priceTypeCode}
        </if>
        <if test="priceItemCode != null and priceItemCode !=''">
            and a.price_item_code = #{priceItemCode}
        </if>
        <if test="priceFrom != null and priceFrom !=''">
            and a.price_tax &gt;= #{priceFrom}
        </if>
        <if test="priceTo != null and priceTo !=''">
            and a.price_tax &lt;= #{priceTo}
        </if>
        <if test="effectiveTimeStartFrom != null">
            and a.effective_time_start&gt;=#{effectiveTimeStartFrom,jdbcType=TIMESTAMP}
        </if>
        <if test="effectiveTimeStartTo != null">
            and a.effective_time_start&lt;=#{effectiveTimeStartTo,jdbcType=TIMESTAMP}
        </if>
        <if test="effectiveTimeEndFrom != null">
            and a.effective_time_end&gt;=#{effectiveTimeEndFrom,jdbcType=TIMESTAMP}
        </if>
        <if test="effectiveTimeEndTo != null">
            and a.effective_time_end&lt;=#{effectiveTimeEndTo,jdbcType=TIMESTAMP}
        </if>
        <if test="productStatus != null and productStatus !=''">
            and b.sku_status = #{productStatus}
        </if>
        <if test="skuCode != null and skuCode !=''">
            and a.sku_code = #{skuCode}
        </if>
        <if test="skuName != null and skuName !=''">
            and a.sku_name LIKE CONCAT('',#{skuName},'%')
        </if>
        <if test="supplierCode != null and supplierCode !=''">
            and a.supplier_code = #{supplierCode}
        </if>
        <if test="purchaseGroupCode != null and purchaseGroupCode !=''">
            and a.purchase_group_code = #{purchaseGroupCode}
        </if>
        <if test="productCategoryCode != null and productCategoryCode !=''">
            and b.product_category_code = #{productCategoryCode}
        </if>
        <if test="productBrandCode != null and productBrandCode !=''">
            and b.product_brand_code = #{productBrandCode}
        </if>
        <if test="productPropertyCode != null and productPropertyCode !=''">
            and b.product_property_code = #{productPropertyCode}
        </if>
        <if test="priceAttributeCode != null and priceAttributeCode !=''">
            and a.price_attribute_code = #{priceAttributeCode}
        </if>
        <if test="batchNumber != null and batchNumber !=''">
            and a.warehouse_batch_number = #{batchNumber}
        </if>
    </select>
    <resultMap id="selectInfoByCode"
               type="com.aiqin.bms.scmp.api.product.domain.response.price.ProductSkuPriceInfoRespVO">
        <result column="asku_code" property="skuCode"/>
        <result column="asku_name" property="skuName"/>
        <result column="apurchase_group_name" property="purchaseGroupName"/>
        <result column="aprice_item_name" property="priceItemName"/>
        <result column="aprice_type_name" property="priceTypeName"/>
        <result column="aprice_attribute_name" property="priceAttributeName"/>
        <result column="aprice_tax" property="priceTax"/>
        <result column="aprice_no_tax" property="priceNoTax"/>
        <result column="atax" property="tax"/>
        <result column="aeffective_time_start" property="effectiveTimeStart"/>
        <result column="aeffective_time_end" property="effectiveTimeEnd"/>
        <result column="asupplier_name" property="supplierName"/>
        <result column="abe_default" property="beDefault"/>
        <result column="aupdate_by" property="updateBy"/>
        <result column="aupdate_time" property="updateTime"/>
        <result column="awarehouse_batch_number" property="warehouseBatchNumber"/>
        <result column="awarehouse_batch_name" property="warehouseBatchName"/>
        <result column="atransport_center_name" property="transportCenterName"/>
        <result column="awarehouse_name" property="warehouseName"/>
        <result column="abatch_remark" property="batchRemark"/>
        <result column="aproduct_time" property="productTime"/>
        <result column="abe_default" property="beDefault"/>
        <result column="asupplier_name" property="supplierName"/>
        <result column="aupdate_by" property="updateBy"/>
        <result column="aupdate_time" property="updateTime"/>
        <result column="abatch_remark" property="batchRemark"/>
        <result column="bproduct_category_name" property="productCategoryName"/>
        <result column="bproduct_brand_name" property="productBrandName"/>
        <result column="bproduct_property_name" property="productPropertyName"/>
        <result column="bsku_status" property="productStatus"/>
        <collection property="areaInfos" ofType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceAreaInfo">
            <result column="ctype" jdbcType="INTEGER" property="type"/>
            <result column="cstatus" jdbcType="INTEGER" property="status"/>
            <result column="cname" jdbcType="VARCHAR" property="name"/>
            <result column="ccode" jdbcType="VARCHAR" property="code"/>
        </collection>
        <collection property="logs" ofType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceInfoLog">
            <id column="did" jdbcType="BIGINT" property="id"/>
            <result column="dcode" jdbcType="VARCHAR" property="code"/>
            <result column="dprice_tax" jdbcType="BIGINT" property="priceTax"/>
            <result column="dprice_no_tax" jdbcType="BIGINT" property="priceNoTax"/>
            <result column="dtax" jdbcType="BIGINT" property="tax"/>
            <result column="deffective_time_start" jdbcType="TIMESTAMP" property="effectiveTimeStart"/>
            <result column="deffective_time_end" jdbcType="TIMESTAMP" property="effectiveTimeEnd"/>
            <result column="dstatus" jdbcType="INTEGER" property="status"/>
            <result column="dcreate_by" jdbcType="VARCHAR" property="createBy"/>
            <result column="dcreate_time" jdbcType="TIMESTAMP" property="createTime"/>
            <result column="dremark" jdbcType="VARCHAR" property="remark"/>
            <result column="darea_info" jdbcType="VARCHAR" property="areaInfo"/>
        </collection>
    </resultMap>
    <resultMap id="selectInfoByCodeNew"
               type="com.aiqin.bms.scmp.api.product.domain.response.price.ProductSkuPriceInfoRespVO1">
        <result column="asku_code" property="skuCode"/>
        <result column="asku_name" property="skuName"/>
        <result column="apurchase_group_name" property="purchaseGroupName"/>
        <result column="aprice_item_name" property="priceItemName"/>
        <result column="aprice_type_name" property="priceTypeName"/>
        <result column="aprice_attribute_name" property="priceAttributeName"/>
        <result column="aprice_tax" property="priceTax"/>
        <result column="aprice_no_tax" property="priceNoTax"/>
        <result column="atax" property="tax"/>
        <result column="aeffective_time_start" property="effectiveTimeStart"/>
        <result column="aeffective_time_end" property="effectiveTimeEnd"/>
        <result column="asupplier_name" property="supplierName"/>
        <result column="abe_default" property="beDefault"/>
        <result column="aupdate_by" property="updateBy"/>
        <result column="aupdate_time" property="updateTime"/>
        <result column="awarehouse_batch_number" property="warehouseBatchNumber"/>
        <result column="awarehouse_batch_name" property="warehouseBatchName"/>
        <result column="atransport_center_name" property="transportCenterName"/>
        <result column="awarehouse_name" property="warehouseName"/>
        <result column="abatch_remark" property="batchRemark"/>
        <result column="aproduct_time" property="productTime"/>
        <result column="abe_default" property="beDefault"/>
        <result column="asupplier_name" property="supplierName"/>
        <result column="aupdate_by" property="updateBy"/>
        <result column="aupdate_time" property="updateTime"/>
        <result column="abatch_remark" property="batchRemark"/>
        <result column="bproduct_category_name" property="productCategoryName"/>
        <result column="bproduct_brand_name" property="productBrandName"/>
        <result column="bproduct_property_name" property="productPropertyName"/>
        <result column="bsku_status" property="productStatus"/>
        <result column="ename" property="saleName"/>
        <collection property="areaInfos" ofType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuSaleAreaInfo">
            <result column="ctype" jdbcType="INTEGER" property="type"/>
            <result column="cmaincode" jdbcType="VARCHAR" property="mainCode"/>
            <result column="cname" jdbcType="VARCHAR" property="name"/>
            <result column="ccode" jdbcType="VARCHAR" property="code"/>
        </collection>
        <collection property="logs" ofType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceInfoLog">
            <id column="did" jdbcType="BIGINT" property="id"/>
            <result column="dcode" jdbcType="VARCHAR" property="code"/>
            <result column="dprice_tax" jdbcType="BIGINT" property="priceTax"/>
            <result column="dprice_no_tax" jdbcType="BIGINT" property="priceNoTax"/>
            <result column="dtax" jdbcType="BIGINT" property="tax"/>
            <result column="deffective_time_start" jdbcType="TIMESTAMP" property="effectiveTimeStart"/>
            <result column="deffective_time_end" jdbcType="TIMESTAMP" property="effectiveTimeEnd"/>
            <result column="dstatus" jdbcType="INTEGER" property="status"/>
            <result column="dcreate_by" jdbcType="VARCHAR" property="createBy"/>
            <result column="dcreate_time" jdbcType="TIMESTAMP" property="createTime"/>
            <result column="dremark" jdbcType="VARCHAR" property="remark"/>
            <result column="darea_info" jdbcType="VARCHAR" property="areaInfo"/>
        </collection>
    </resultMap>
    <select id="selectInfoByCode"  parameterType="java.lang.String" resultMap="selectInfoByCode">

      SELECT
             a.sku_code               asku_code,
             a.sku_name               asku_name,
             a.price_item_name        aprice_item_name,
             a.price_type_name        aprice_type_name,
             a.price_attribute_name   aprice_attribute_name,
             a.price_tax              aprice_tax,
             a.price_no_tax           aprice_no_tax,
             a.tax                    atax,
             a.purchase_group_name    apurchase_group_name,
             a.warehouse_batch_number awarehouse_batch_number,
             a.transport_center_name  atransport_center_name,
             a.warehouse_name         awarehouse_name,
             a.batch_remark           abatch_remark,
             a.effective_time_start   aeffective_time_start,
             a.effective_time_end     aeffective_time_end,
             a.be_default             abe_default,
             a.product_time           aproduct_time,
             a.supplier_name          asupplier_name,
             a.be_default             abe_default,
             a.update_by              aupdate_by,
             a.update_time            aupdate_time,
             a.batch_remark           abatch_remark,
             b.sku_status             bsku_status,
             b.product_category_name  bproduct_category_name,
             b.product_brand_name     bproduct_brand_name,
             b.product_property_name  bproduct_property_name,
             c.`code`                 ccode,
              c.`code`            cmaincode,
             d.id                     did,
             d.code                   dcode,
             d.price_tax              dprice_tax,
             d.price_no_tax           dprice_no_tax,
             d.tax                    dtax,
             d.effective_time_start   deffective_time_start,
             d.effective_time_end     deffective_time_end,
             d.status                 dstatus,
             d.create_by              dcreate_by,
             d.create_time            dcreate_time,
             d.remark                 dremark,
             d.area_info              darea_info,
             e.`name`                 ename
      FROM product_sku_price_info a
             LEFT JOIN product_sku b
                       ON a.sku_code = b.sku_code
             LEFT JOIN product_sku_sale_area c
                       ON a.sku_code  = c.sku_code
             LEFT JOIN product_sku_price_info_log d
                       ON d.code = a.code
             LEFT JOIN product_sku_sale_area_main e
                       ON c.code = e.code
                    where a.code = #{code}
  </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    delete from product_sku_price_info
    where id = #{id,jdbcType=BIGINT}
  </delete>
    <insert id="insert" parameterType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceInfo">
    insert into product_sku_price_info (id, code, sku_code, 
      sku_name, purchase_group_code, purchase_group_name, 
      price_item_code, price_item_name, price_type_code, 
      price_type_name, price_attribute_code, price_attribute_name, 
      price_tax, price_no_tax, tax, 
      effective_time_start, effective_time_end, 
      supplier_code, supplier_name, be_default, 
      create_by, create_time, update_by, 
      update_time, warehouse_batch_number, warehouse_batch_name, 
      transport_center_code, transport_center_name, 
      warehouse_code, warehouse_name, batch_remark, 
      product_time, apply_code, company_code, 
      company_name, be_synchronous,
      be_contain_area)
    values (#{id,jdbcType=BIGINT}, #{code,jdbcType=VARCHAR}, #{skuCode,jdbcType=VARCHAR}, 
      #{skuName,jdbcType=VARCHAR}, #{purchaseGroupCode,jdbcType=VARCHAR}, #{purchaseGroupName,jdbcType=VARCHAR}, 
      #{priceItemCode,jdbcType=VARCHAR}, #{priceItemName,jdbcType=VARCHAR}, #{priceTypeCode,jdbcType=VARCHAR}, 
      #{priceTypeName,jdbcType=VARCHAR}, #{priceAttributeCode,jdbcType=VARCHAR}, #{priceAttributeName,jdbcType=VARCHAR}, 
      #{priceTax,jdbcType=BIGINT}, #{priceNoTax,jdbcType=BIGINT}, #{tax,jdbcType=BIGINT}, 
      #{effectiveTimeStart,jdbcType=TIMESTAMP}, #{effectiveTimeEnd,jdbcType=TIMESTAMP}, 
      #{supplierCode,jdbcType=VARCHAR}, #{supplierName,jdbcType=VARCHAR}, #{beDefault,jdbcType=INTEGER}, 
      #{createBy,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP}, #{updateBy,jdbcType=VARCHAR}, 
      #{updateTime,jdbcType=TIMESTAMP}, #{warehouseBatchNumber,jdbcType=VARCHAR}, #{warehouseBatchName,jdbcType=VARCHAR}, 
      #{transportCenterCode,jdbcType=VARCHAR}, #{transportCenterName,jdbcType=VARCHAR}, 
      #{warehouseCode,jdbcType=VARCHAR}, #{warehouseName,jdbcType=VARCHAR}, #{batchRemark,jdbcType=VARCHAR}, 
      #{productTime,jdbcType=TIMESTAMP}, #{applyCode,jdbcType=VARCHAR}, #{companyCode,jdbcType=VARCHAR}, 
      #{companyName,jdbcType=VARCHAR}, #{beSynchronous,jdbcType=INTEGER},
      #{beContainArea,jdbcType=INTEGER})
  </insert>
    <insert id="insertSelective" parameterType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceInfo">
        insert into product_sku_price_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="code != null">
                code,
            </if>
            <if test="skuCode != null">
                sku_code,
            </if>
            <if test="skuName != null">
                sku_name,
            </if>
            <if test="purchaseGroupCode != null">
                purchase_group_code,
            </if>
            <if test="purchaseGroupName != null">
                purchase_group_name,
            </if>
            <if test="priceItemCode != null">
                price_item_code,
            </if>
            <if test="priceItemName != null">
                price_item_name,
            </if>
            <if test="priceTypeCode != null">
                price_type_code,
            </if>
            <if test="priceTypeName != null">
                price_type_name,
            </if>
            <if test="priceAttributeCode != null">
                price_attribute_code,
            </if>
            <if test="priceAttributeName != null">
                price_attribute_name,
            </if>
            <if test="priceTax != null">
                price_tax,
            </if>
            <if test="priceNoTax != null">
                price_no_tax,
            </if>
            <if test="tax != null">
                tax,
            </if>
            <if test="effectiveTimeStart != null">
                effective_time_start,
            </if>
            <if test="effectiveTimeEnd != null">
                effective_time_end,
            </if>
            <if test="supplierCode != null">
                supplier_code,
            </if>
            <if test="supplierName != null">
                supplier_name,
            </if>
            <if test="beDefault != null">
                be_default,
            </if>
            <if test="createBy != null">
                create_by,
            </if>
            <if test="createTime != null">
                create_time,
            </if>
            <if test="updateBy != null">
                update_by,
            </if>
            <if test="updateTime != null">
                update_time,
            </if>
            <if test="warehouseBatchNumber != null">
                warehouse_batch_number,
            </if>
            <if test="warehouseBatchName != null">
                warehouse_batch_name,
            </if>
            <if test="transportCenterCode != null">
                transport_center_code,
            </if>
            <if test="transportCenterName != null">
                transport_center_name,
            </if>
            <if test="warehouseCode != null">
                warehouse_code,
            </if>
            <if test="warehouseName != null">
                warehouse_name,
            </if>
            <if test="batchRemark != null">
                batch_remark,
            </if>
            <if test="productTime != null">
                product_time,
            </if>
            <if test="applyCode != null">
                apply_code,
            </if>
            <if test="companyCode != null">
                company_code,
            </if>
            <if test="companyName != null">
                company_name,
            </if>
            <if test="beSynchronous != null">
                be_synchronous,
            </if>
            <if test="beContainArea != null">
                be_contain_area,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=BIGINT},
            </if>
            <if test="code != null">
                #{code,jdbcType=VARCHAR},
            </if>
            <if test="skuCode != null">
                #{skuCode,jdbcType=VARCHAR},
            </if>
            <if test="skuName != null">
                #{skuName,jdbcType=VARCHAR},
            </if>
            <if test="purchaseGroupCode != null">
                #{purchaseGroupCode,jdbcType=VARCHAR},
            </if>
            <if test="purchaseGroupName != null">
                #{purchaseGroupName,jdbcType=VARCHAR},
            </if>
            <if test="priceItemCode != null">
                #{priceItemCode,jdbcType=VARCHAR},
            </if>
            <if test="priceItemName != null">
                #{priceItemName,jdbcType=VARCHAR},
            </if>
            <if test="priceTypeCode != null">
                #{priceTypeCode,jdbcType=VARCHAR},
            </if>
            <if test="priceTypeName != null">
                #{priceTypeName,jdbcType=VARCHAR},
            </if>
            <if test="priceAttributeCode != null">
                #{priceAttributeCode,jdbcType=VARCHAR},
            </if>
            <if test="priceAttributeName != null">
                #{priceAttributeName,jdbcType=VARCHAR},
            </if>
            <if test="priceTax != null">
                #{priceTax,jdbcType=BIGINT},
            </if>
            <if test="priceNoTax != null">
                #{priceNoTax,jdbcType=BIGINT},
            </if>
            <if test="tax != null">
                #{tax,jdbcType=BIGINT},
            </if>
            <if test="effectiveTimeStart != null">
                #{effectiveTimeStart,jdbcType=TIMESTAMP},
            </if>
            <if test="effectiveTimeEnd != null">
                #{effectiveTimeEnd,jdbcType=TIMESTAMP},
            </if>
            <if test="supplierCode != null">
                #{supplierCode,jdbcType=VARCHAR},
            </if>
            <if test="supplierName != null">
                #{supplierName,jdbcType=VARCHAR},
            </if>
            <if test="beDefault != null">
                #{beDefault,jdbcType=INTEGER},
            </if>
            <if test="createBy != null">
                #{createBy,jdbcType=VARCHAR},
            </if>
            <if test="createTime != null">
                #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateBy != null">
                #{updateBy,jdbcType=VARCHAR},
            </if>
            <if test="updateTime != null">
                #{updateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="warehouseBatchNumber != null">
                #{warehouseBatchNumber,jdbcType=VARCHAR},
            </if>
            <if test="warehouseBatchName != null">
                #{warehouseBatchName,jdbcType=VARCHAR},
            </if>
            <if test="transportCenterCode != null">
                #{transportCenterCode,jdbcType=VARCHAR},
            </if>
            <if test="transportCenterName != null">
                #{transportCenterName,jdbcType=VARCHAR},
            </if>
            <if test="warehouseCode != null">
                #{warehouseCode,jdbcType=VARCHAR},
            </if>
            <if test="warehouseName != null">
                #{warehouseName,jdbcType=VARCHAR},
            </if>
            <if test="batchRemark != null">
                #{batchRemark,jdbcType=VARCHAR},
            </if>
            <if test="productTime != null">
                #{productTime,jdbcType=TIMESTAMP},
            </if>
            <if test="applyCode != null">
                #{applyCode,jdbcType=VARCHAR},
            </if>
            <if test="companyCode != null">
                #{companyCode,jdbcType=VARCHAR},
            </if>
            <if test="companyName != null">
                #{companyName,jdbcType=VARCHAR},
            </if>
            <if test="beSynchronous != null">
                #{beSynchronous,jdbcType=INTEGER},
            </if>
            <if test="beContainArea != null">
                #{beContainArea,jdbcType=INTEGER},
            </if>
        </trim>
    </insert>
    <insert id="insertBatch">
        insert into product_sku_price_info (code, sku_code,
        sku_name, purchase_group_code, purchase_group_name,
        price_item_code, price_item_name, price_type_code,
        price_type_name, price_attribute_code, price_attribute_name,
        price_tax, price_no_tax, tax,
        effective_time_start, effective_time_end,
        supplier_code, supplier_name, be_default,
        create_by, create_time, update_by,
        update_time, warehouse_batch_number, warehouse_batch_name,
        transport_center_code, transport_center_name,
        warehouse_code, warehouse_name, batch_remark,
        product_time, apply_code, company_code,
        company_name, be_synchronous,
        be_contain_area)
        values
        <foreach collection="items" item="item" open="" close="" separator=",">
            (
            #{item.code,jdbcType=VARCHAR}, #{item.skuCode,jdbcType=VARCHAR},
            #{item.skuName,jdbcType=VARCHAR}, #{item.purchaseGroupCode,jdbcType=VARCHAR},
            #{item.purchaseGroupName,jdbcType=VARCHAR},
            #{item.priceItemCode,jdbcType=VARCHAR}, #{item.priceItemName,jdbcType=VARCHAR},
            #{item.priceTypeCode,jdbcType=VARCHAR},
            #{item.priceTypeName,jdbcType=VARCHAR}, #{item.priceAttributeCode,jdbcType=VARCHAR},
            #{item.priceAttributeName,jdbcType=VARCHAR},
            #{item.priceTax,jdbcType=BIGINT}, #{item.priceNoTax,jdbcType=BIGINT}, #{item.tax,jdbcType=BIGINT},
            #{item.effectiveTimeStart,jdbcType=TIMESTAMP}, #{item.effectiveTimeEnd,jdbcType=TIMESTAMP},
            #{item.supplierCode,jdbcType=VARCHAR}, #{item.supplierName,jdbcType=VARCHAR},
            #{item.beDefault,jdbcType=INTEGER},
            #{item.createBy,jdbcType=VARCHAR}, #{item.createTime,jdbcType=TIMESTAMP}, #{item.updateBy,jdbcType=VARCHAR},
            #{item.updateTime,jdbcType=TIMESTAMP}, #{item.warehouseBatchNumber,jdbcType=VARCHAR},
            #{item.warehouseBatchName,jdbcType=VARCHAR},
            #{item.transportCenterCode,jdbcType=VARCHAR}, #{item.transportCenterName,jdbcType=VARCHAR},
            #{item.warehouseCode,jdbcType=VARCHAR}, #{item.warehouseName,jdbcType=VARCHAR},
            #{item.batchRemark,jdbcType=VARCHAR},
            #{item.productTime,jdbcType=TIMESTAMP}, #{item.applyCode,jdbcType=VARCHAR},
            #{item.companyCode,jdbcType=VARCHAR},
            #{item.companyName,jdbcType=VARCHAR}, #{item.beSynchronous,jdbcType=INTEGER},
            #{item.beContainArea,jdbcType=INTEGER}
            )
        </foreach>
    </insert>
    <update id="updateByPrimaryKeySelective"
            parameterType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceInfo">
        update product_sku_price_info
        <set>
            <if test="code != null">
                code = #{code,jdbcType=VARCHAR},
            </if>
            <if test="skuCode != null">
                sku_code = #{skuCode,jdbcType=VARCHAR},
            </if>
            <if test="skuName != null">
                sku_name = #{skuName,jdbcType=VARCHAR},
            </if>
            <if test="purchaseGroupCode != null">
                purchase_group_code = #{purchaseGroupCode,jdbcType=VARCHAR},
            </if>
            <if test="purchaseGroupName != null">
                purchase_group_name = #{purchaseGroupName,jdbcType=VARCHAR},
            </if>
            <if test="priceItemCode != null">
                price_item_code = #{priceItemCode,jdbcType=VARCHAR},
            </if>
            <if test="priceItemName != null">
                price_item_name = #{priceItemName,jdbcType=VARCHAR},
            </if>
            <if test="priceTypeCode != null">
                price_type_code = #{priceTypeCode,jdbcType=VARCHAR},
            </if>
            <if test="priceTypeName != null">
                price_type_name = #{priceTypeName,jdbcType=VARCHAR},
            </if>
            <if test="priceAttributeCode != null">
                price_attribute_code = #{priceAttributeCode,jdbcType=VARCHAR},
            </if>
            <if test="priceAttributeName != null">
                price_attribute_name = #{priceAttributeName,jdbcType=VARCHAR},
            </if>
            <if test="priceTax != null">
                price_tax = #{priceTax,jdbcType=BIGINT},
            </if>
            <if test="priceNoTax != null">
                price_no_tax = #{priceNoTax,jdbcType=BIGINT},
            </if>
            <if test="tax != null">
                tax = #{tax,jdbcType=BIGINT},
            </if>
            <if test="effectiveTimeStart != null">
                effective_time_start = #{effectiveTimeStart,jdbcType=TIMESTAMP},
            </if>
            <if test="effectiveTimeEnd != null">
                effective_time_end = #{effectiveTimeEnd,jdbcType=TIMESTAMP},
            </if>
            <if test="supplierCode != null">
                supplier_code = #{supplierCode,jdbcType=VARCHAR},
            </if>
            <if test="supplierName != null">
                supplier_name = #{supplierName,jdbcType=VARCHAR},
            </if>
            <if test="beDefault != null">
                be_default = #{beDefault,jdbcType=INTEGER},
            </if>
            <if test="createBy != null">
                create_by = #{createBy,jdbcType=VARCHAR},
            </if>
            <if test="createTime != null">
                create_time = #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateBy != null">
                update_by = #{updateBy,jdbcType=VARCHAR},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="warehouseBatchNumber != null">
                warehouse_batch_number = #{warehouseBatchNumber,jdbcType=VARCHAR},
            </if>
            <if test="warehouseBatchName != null">
                warehouse_batch_name = #{warehouseBatchName,jdbcType=VARCHAR},
            </if>
            <if test="transportCenterCode != null">
                transport_center_code = #{transportCenterCode,jdbcType=VARCHAR},
            </if>
            <if test="transportCenterName != null">
                transport_center_name = #{transportCenterName,jdbcType=VARCHAR},
            </if>
            <if test="warehouseCode != null">
                warehouse_code = #{warehouseCode,jdbcType=VARCHAR},
            </if>
            <if test="warehouseName != null">
                warehouse_name = #{warehouseName,jdbcType=VARCHAR},
            </if>
            <if test="batchRemark != null">
                batch_remark = #{batchRemark,jdbcType=VARCHAR},
            </if>
            <if test="productTime != null">
                product_time = #{productTime,jdbcType=TIMESTAMP},
            </if>
            <if test="applyCode != null">
                apply_code = #{applyCode,jdbcType=VARCHAR},
            </if>
            <if test="companyCode != null">
                company_code = #{companyCode,jdbcType=VARCHAR},
            </if>
            <if test="companyName != null">
                company_name = #{companyName,jdbcType=VARCHAR},
            </if>
            <if test="beSynchronous != null">
                be_synchronous = #{beSynchronous,jdbcType=INTEGER},
            </if>
            <if test="beContainArea != null">
                be_contain_area = #{beContainArea,jdbcType=INTEGER},
            </if>
        </set>
        where id = #{id,jdbcType=BIGINT}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceInfo">
    update product_sku_price_info
    set code = #{code,jdbcType=VARCHAR},
      sku_code = #{skuCode,jdbcType=VARCHAR},
      sku_name = #{skuName,jdbcType=VARCHAR},
      purchase_group_code = #{purchaseGroupCode,jdbcType=VARCHAR},
      purchase_group_name = #{purchaseGroupName,jdbcType=VARCHAR},
      price_item_code = #{priceItemCode,jdbcType=VARCHAR},
      price_item_name = #{priceItemName,jdbcType=VARCHAR},
      price_type_code = #{priceTypeCode,jdbcType=VARCHAR},
      price_type_name = #{priceTypeName,jdbcType=VARCHAR},
      price_attribute_code = #{priceAttributeCode,jdbcType=VARCHAR},
      price_attribute_name = #{priceAttributeName,jdbcType=VARCHAR},
      price_tax = #{priceTax,jdbcType=BIGINT},
      price_no_tax = #{priceNoTax,jdbcType=BIGINT},
      tax = #{tax,jdbcType=BIGINT},
      effective_time_start = #{effectiveTimeStart,jdbcType=TIMESTAMP},
      effective_time_end = #{effectiveTimeEnd,jdbcType=TIMESTAMP},
      supplier_code = #{supplierCode,jdbcType=VARCHAR},
      supplier_name = #{supplierName,jdbcType=VARCHAR},
      be_default = #{beDefault,jdbcType=INTEGER},
      create_by = #{createBy,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      update_by = #{updateBy,jdbcType=VARCHAR},
      update_time = #{updateTime,jdbcType=TIMESTAMP},
      warehouse_batch_number = #{warehouseBatchNumber,jdbcType=VARCHAR},
      warehouse_batch_name = #{warehouseBatchName,jdbcType=VARCHAR},
      transport_center_code = #{transportCenterCode,jdbcType=VARCHAR},
      transport_center_name = #{transportCenterName,jdbcType=VARCHAR},
      warehouse_code = #{warehouseCode,jdbcType=VARCHAR},
      warehouse_name = #{warehouseName,jdbcType=VARCHAR},
      batch_remark = #{batchRemark,jdbcType=VARCHAR},
      product_time = #{productTime,jdbcType=TIMESTAMP},
      apply_code = #{applyCode,jdbcType=VARCHAR},
      company_code = #{companyCode,jdbcType=VARCHAR},
      company_name = #{companyName,jdbcType=VARCHAR},
      be_synchronous = #{beSynchronous,jdbcType=INTEGER},
      be_contain_area = #{beContainArea,jdbcType=INTEGER}
    where id = #{id,jdbcType=BIGINT}
  </update>
    <update id="updateBatch">
        <foreach collection="items" item="item" open="" close="" separator=";">
            update product_sku_price_info
            set code = #{item.code,jdbcType=VARCHAR},
            sku_code = #{item.skuCode,jdbcType=VARCHAR},
            sku_name = #{item.skuName,jdbcType=VARCHAR},
            purchase_group_code = #{item.purchaseGroupCode,jdbcType=VARCHAR},
            purchase_group_name = #{item.purchaseGroupName,jdbcType=VARCHAR},
            price_item_code = #{item.priceItemCode,jdbcType=VARCHAR},
            price_item_name = #{item.priceItemName,jdbcType=VARCHAR},
            price_type_code = #{item.priceTypeCode,jdbcType=VARCHAR},
            price_type_name = #{item.priceTypeName,jdbcType=VARCHAR},
            price_attribute_code = #{item.priceAttributeCode,jdbcType=VARCHAR},
            price_attribute_name = #{item.priceAttributeName,jdbcType=VARCHAR},
            price_tax = #{item.priceTax,jdbcType=BIGINT},
            price_no_tax = #{item.priceNoTax,jdbcType=BIGINT},
            tax = #{item.tax,jdbcType=BIGINT},
            effective_time_start = #{item.effectiveTimeStart,jdbcType=TIMESTAMP},
            effective_time_end = #{item.effectiveTimeEnd,jdbcType=TIMESTAMP},
            supplier_code = #{item.supplierCode,jdbcType=VARCHAR},
            supplier_name = #{item.supplierName,jdbcType=VARCHAR},
            be_default = #{item.beDefault,jdbcType=INTEGER},
            create_by = #{item.createBy,jdbcType=VARCHAR},
            create_time = #{item.createTime,jdbcType=TIMESTAMP},
            update_by = #{item.updateBy,jdbcType=VARCHAR},
            update_time = #{item.updateTime,jdbcType=TIMESTAMP},
            warehouse_batch_number = #{item.warehouseBatchNumber,jdbcType=VARCHAR},
            warehouse_batch_name = #{item.warehouseBatchName,jdbcType=VARCHAR},
            transport_center_code = #{item.transportCenterCode,jdbcType=VARCHAR},
            transport_center_name = #{item.transportCenterName,jdbcType=VARCHAR},
            warehouse_code = #{item.warehouseCode,jdbcType=VARCHAR},
            warehouse_name = #{item.warehouseName,jdbcType=VARCHAR},
            batch_remark = #{item.batchRemark,jdbcType=VARCHAR},
            product_time = #{item.productTime,jdbcType=TIMESTAMP},
            apply_code = #{item.applyCode,jdbcType=VARCHAR},
            company_code = #{item.companyCode,jdbcType=VARCHAR},
            company_name = #{item.companyName,jdbcType=VARCHAR},
            be_synchronous = #{item.beSynchronous,jdbcType=INTEGER},
            be_contain_area = #{item.beContainArea,jdbcType=INTEGER}
            where id = #{item.id,jdbcType=BIGINT}
        </foreach>
    </update>
    <select id="selectPriceTax" resultType="java.math.BigDecimal">
    select price_tax from product_sku_price_info
    where sku_code = #{skuCode} and supplier_code = #{supplierCode} and price_attribute_code = 2 and price_type_code = 2 limit 1
  </select>
    <select id="selectBySkuCodeForOfficial"
            resultType="com.aiqin.bms.scmp.api.product.domain.response.price.ProductSkuPriceRespVo">
        select
            a.sku_code skuCode,
            a.sku_name skuName,
            a.price_item_name priceItemName,
            a.price_item_code priceItemCode,
            a.price_type_code priceTypeCode,
            a.price_type_name priceTypeName,
            a.price_attribute_code priceAttributeCode,
            a.price_attribute_name priceAttributeName,
            a.price_tax priceTax,
            a.effective_time_start effectiveTimeStart,
            a.supplier_name supplierName
         from product_sku_price_info a
        where a.sku_code = #{skuCode} and a.company_code = #{companyCode}
        and a.be_contain_area = 0 and a.price_attribute_code in (1,2)
    </select>
    <select id="selectBySkuCodeForApply"
            resultType="com.aiqin.bms.scmp.api.product.domain.response.price.ProductSkuPriceRespVo">
        select
        a.sku_code skuCode,
        a.sku_name skuName,
        a.price_item_name priceItemName,
        a.price_item_code priceItemCode,
        a.price_type_code priceTypeCode,
        a.price_type_name priceTypeName,
        a.price_attribute_code priceAttributeCode,
        a.price_attribute_name priceAttributeName,
        a.price_tax priceTax,
        a.effective_time_start effectiveTimeStart,
        a.supplier_name supplierName
        from apply_product_sku_price_info a
        where a.sku_code = #{skuCode}
        <if test="companyCode != null and companyCode != '' ">
            and a.company_code = #{companyCode}
        </if>
        and a.be_contain_area = 0 and a.price_attribute_code in (1,2) and a.apply_code = #{applyCode}
    </select>
    <select id="selectBySkuCodeForDraft"
            resultType="com.aiqin.bms.scmp.api.product.domain.response.price.ProductSkuPriceRespVo">
         select
            a.sku_code skuCode,
            a.sku_name skuName,
            a.price_item_name priceItemName,
            a.price_item_code priceItemCode,
            a.price_type_code priceTypeCode,
            a.price_type_name priceTypeName,
            a.price_attribute_code priceAttributeCode,
            a.price_attribute_name priceAttributeName,
            a.price_tax priceTax,
            a.effective_time_start effectiveTimeStart,
            a.supplier_name supplierName
         from product_sku_price_info_draft a
        where a.sku_code = #{skuCode} and a.company_code = #{companyCode}
        and a.be_contain_area = 0 and a.price_attribute_code in (1,2)
  </select>
    <select id="getPriceJog" resultType="com.aiqin.bms.scmp.api.product.domain.response.changeprice.PriceJog">
        select DATE_FORMAT(a.create_time, '%Y/%m') month,
               ROUND(avg(a.price_tax),0) price ,
               sku_code skuCode
                from
                (SELECT
                 a.price_tax, a.create_time, p.sku_code
                 FROM
                 product_sku_price_info_log a
                 left join product_sku_price_info p
                 on a.code = p.code
                 WHERE
                 p.price_attribute_code = 1 and a.status = 2 and DATE_FORMAT(a.create_time, '%Y') in(#{year},#{year}-1)
                 union
                 SELECT
                 p.price_tax, p.create_time, p.sku_code
                 FROM
                 product_sku_price_info p
                 WHERE
                 p.price_attribute_code = 1 and DATE_FORMAT(p.create_time, '%Y') in(#{year},#{year}-1)
                ) a
        where a.sku_code = #{skuCode}
        GROUP BY DATE_FORMAT(create_time, '%Y/%m'),sku_code order by create_time;
    </select>
    <resultMap id="selectChannelPriceBySkuCode" type="com.aiqin.bms.scmp.api.product.domain.pojo.ProductSkuPriceInfo">
        <result column="skuCode" property="skuCode"/>
        <result column="priceTax" property="priceTax"/>
    </resultMap>
    <select id="selectChannelPriceBySkuCode" parameterType="java.util.List" resultMap="selectChannelPriceBySkuCode">
        select sku_code skuCode,
         max(price_tax) priceTax
        from product_sku_price_info a
        where a.price_type_code = 2
          and a.price_attribute_code = 2 and a.be_contain_area = 0
        and a.sku_code in
        <foreach collection="list" open="(" close=")" item="item" separator=",">
            #{item.skuCode}
        </foreach>
        group by sku_code
    </select>
    <select id="getDistributionPriceByProductCode" resultType="java.math.BigDecimal">
        select  price_tax from  product_sku_price_info
        <where>
            sku_code =  #{productCode} and
            price_item_code =  #{categoriesSupplyChannelsCode} and
            price_type_code =2
        </where>
    </select>
</mapper>